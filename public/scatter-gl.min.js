/* Copyright 2019 Google LLC All Rights Reserved.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
  ==============================================================================*/
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("THREE"));else if("function"==typeof define&&define.amd)define(["THREE"],e);else{var i="object"==typeof exports?e(require("THREE")):e(t.THREE);for(var o in i)("object"==typeof exports?exports:t)[o]=i[o]}}(window,function(t){return function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=4)}([function(e,i){e.exports=t},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(0);function n(t,e){return void 0===e&&(e=!0),t.needsUpdate=e,t.minFilter=o.LinearFilter,t.generateMipmaps=!1,t.flipY=!1,t}e.vector3DToScreenCoords=function(t,e,i,n){var r=window.devicePixelRatio,s=(new o.Vector3).copy(n).project(t);return[(s.x+1)/2*e*r,-(s.y-1)/2*i*r]},e.vector3FromPackedArray=function(t,e){var i=3*e;return new o.Vector3(t[i],t[i+1],t[i+2])},e.getNearFarPoints=function(t,e,i){for(var n=1/0,r=0,s=(new o.Vector3).copy(i).sub(e),a=(new o.Vector3).copy(s).normalize(),l=t.length/3,h=0,c=new o.Vector3,u=new o.Vector3,p=0;p<l;p++){c.x=t[h],c.y=t[h+1],c.z=t[h+2],h+=3,u.copy(c).sub(e);var d=a.dot(u);d<0||(r=d>r?d:r,n=d<n?d:n)}return[n,r]},e.createTextureFromCanvas=function(t){return n(new o.Texture(t))},e.createTextureFromImage=function(t,e){var i=new o.Texture(t);return t.onload=function(){i.needsUpdate=!0,e()},n(i,!1)},e.hasWebGLSupport=function(){try{var t=document.createElement("canvas");return null!=(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(t){return!1}},e.extent=function(t){for(var e=1/0,i=-1/0,o=0;o<t.length;o++){var n=t[o];n<e&&(e=n),n>i&&(i=n)}return[e,i]},e.scaleLinear=function(t,e,i){var o=e[1]-e[0],n=i[1]-i[0];return(t-e[0])/o*n+i[0]},e.scaleExponential=function(t,e,i){var o=Math.pow(e[1],Math.E)-Math.pow(e[0],Math.E),n=i[1]-i[0];return(Math.pow(t,Math.E)-e[0])/o*n+i[0]},e.packRgbIntoUint8Array=function(t,e,i,o,n){t[3*e]=i,t[3*e+1]=o,t[3*e+2]=n},e.styleRgbFromHexColor=function(t){var e=new o.Color(t);return[255*e.r|0,255*e.g|0,255*e.b|0]};var r=function(t){return 100*t+"%"};e.getDefaultPointInPolylineColor=function(t,e,i,n,s,a){var l="hsl("+(i+(n-i)*t/e)+", "+r(s)+", "+r(a)+")";return new o.Color(l)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){return function(t,e,i,o,n,r,s){this.pointIndices=t,this.labelStrings=e,this.scaleFactors=i,this.useSceneOpacityFlags=o,this.defaultFontSize=n,this.fillColors=r,this.strokeColors=s}}();e.LabelRenderParams=o,function(t){t[t.Perspective=0]="Perspective",t[t.Orthographic=1]="Orthographic"}(e.CameraType||(e.CameraType={}));var n=function(){return function(t,e,i,o,n,r,s,a,l,h,c,u,p,d){this.camera=t,this.cameraType=e,this.cameraTarget=i,this.screenWidth=o,this.screenHeight=n,this.nearestCameraSpacePointZ=r,this.farthestCameraSpacePointZ=s,this.backgroundColor=a,this.pointColors=l,this.pointScaleFactors=h,this.labels=c,this.polylineColors=u,this.polylineOpacities=p,this.polylineWidths=d}}();e.RenderContext=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RGB_NUM_ELEMENTS=3,e.RGBA_NUM_ELEMENTS=4,e.XYZ_NUM_ELEMENTS=3,e.UV_NUM_ELEMENTS=2,e.INDEX_NUM_ELEMENTS=1,e.SCATTER_PLOT_CUBE_LENGTH=2},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(5);e.ScatterGL=o.ScatterGL},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(6),n=i(9),r=i(10),s=i(2),a=i(11),l=i(1),h=i(3),c=i(12),u=i(13),p=i(14),d=i(16),f=function(){function t(t,e){var i=this;void 0===e&&(e={}),this.pointColorer=null,this.sequences=[],this.renderMode="POINT",this.rotateOnStart=!0,this.selectEnabled=!0,this.showLabelsOnHover=!0,this.hoverPointIndex=null,this.selectedPointIndices=[],this.clickCallback=function(){},this.hoverCallback=function(){},this.selectCallback=function(){},this.cameraMoveCallback=function(){},this.onHover=function(t){i.hoverCallback(t),i.hoverPointIndex=t,i.updateScatterPlotAttributes(),i.renderScatterPlot()},this.onClick=function(t){i.clickCallback(t)},this.onSelect=function(t){i.selectEnabled&&(i.selectCallback(t),i.selectedPointIndices=t,i.updateScatterPlotAttributes(),i.renderScatterPlot())},this.containerElement=t,this.styles=a.makeStyles(e.styles),this.setParameters(e),this.scatterPlot=new o.ScatterPlot(t,{camera:e.camera,onClick:this.onClick,onHover:this.onHover,onSelect:this.onSelect,selectEnabled:this.selectEnabled,styles:this.styles}),this.scatterPlot.onCameraMove(this.cameraMoveCallback)}return t.prototype.setParameters=function(t){void 0!==t.onClick&&(this.clickCallback=t.onClick),void 0!==t.onHover&&(this.hoverCallback=t.onHover),void 0!==t.onSelect&&(this.selectCallback=t.onSelect),void 0!==t.onCameraMove&&(this.cameraMoveCallback=t.onCameraMove),void 0!==t.pointColorer&&(this.pointColorer=t.pointColorer),void 0!==t.renderMode&&(this.renderMode=t.renderMode),void 0!==t.rotateOnStart&&(this.rotateOnStart=t.rotateOnStart),void 0!==t.selectEnabled&&(this.selectEnabled=t.selectEnabled),void 0!==t.showLabelsOnHover&&(this.showLabelsOnHover=t.showLabelsOnHover)},t.prototype.render=function(t){this.updateDataset(t),this.setVisualizers(),this.rotateOnStart&&this.scatterPlot.startOrbitAnimation()},t.prototype.renderScatterPlot=function(){this.dataset&&this.scatterPlot.render()},t.prototype.setRenderMode=function(t){this.renderMode=t,this.setVisualizers(),this.updateScatterPlotAttributes(),this.updateScatterPlotPositions()},t.prototype.setTextRenderMode=function(){this.setRenderMode("TEXT"),this.renderScatterPlot()},t.prototype.setPointRenderMode=function(){this.setRenderMode("POINT"),this.renderScatterPlot()},t.prototype.setSpriteRenderMode=function(){this.dataset&&this.dataset.spriteMetadata&&(this.setRenderMode("SPRITE"),this.renderScatterPlot())},t.prototype.setSequences=function(t){this.sequences=t,this.updatePolylineAttributes(),this.setVisualizers(),this.renderScatterPlot()},t.prototype.setPanMode=function(){this.scatterPlot.setInteractionMode("PAN")},t.prototype.setSelectMode=function(){this.scatterPlot.setInteractionMode("SELECT")},t.prototype.setDimensions=function(t){var e=t<2||t>3,i=this.dataset&&t>this.dataset.dimensions;if(e||i)throw new RangeError("Setting invalid dimensionality");this.scatterPlot.setDimensions(t),this.renderScatterPlot()},t.prototype.setPointColorer=function(t){this.pointColorer=t,this.updateScatterPlotAttributes(),this.renderScatterPlot()},t.prototype.setHoverPointIndex=function(t){this.hoverPointIndex=t,this.updateScatterPlotAttributes(),this.scatterPlot.orbitIsAnimating()||this.renderScatterPlot()},t.prototype.resize=function(){this.scatterPlot.resize()},t.prototype.updateDataset=function(t){this.setDataset(t),this.scatterPlot.setDimensions(t.dimensions),this.updateScatterPlotAttributes(),this.updateScatterPlotPositions(),this.renderScatterPlot()},t.prototype.startOrbitAnimation=function(){this.scatterPlot.startOrbitAnimation()},t.prototype.stopOrbitAnimation=function(){this.scatterPlot.stopOrbitAnimation()},t.prototype.setDataset=function(t){this.dataset=t,this.labels3DVisualizer&&this.labels3DVisualizer.setLabelStrings(this.generate3DLabelsArray())},t.prototype.updateScatterPlotPositions=function(){var t=this.dataset;if(t){var e=this.generatePointPositionArray(t);this.scatterPlot.setPointPositions(e)}},t.prototype.updateScatterPlotAttributes=function(){var t=this.dataset;if(t){var e=this.generatePointColorArray(t),i=this.generatePointScaleFactorArray(t),o=this.generateVisibleLabelRenderParams(t);this.scatterPlot.setPointColors(e),this.scatterPlot.setPointScaleFactors(i),this.scatterPlot.setLabels(o)}},t.prototype.updatePolylineAttributes=function(){var t=this.dataset;if(t){var e=this.generateLineSegmentColorMap(t),i=this.generateLineSegmentOpacityArray(t),o=this.generateLineSegmentWidthArray(t);this.scatterPlot.setPolylineColors(e),this.scatterPlot.setPolylineOpacities(i),this.scatterPlot.setPolylineWidths(o)}},t.prototype.generatePointPositionArray=function(t){var e,i,o=[0,0];e=l.extent(t.points.map(function(t){return t[0]})),i=l.extent(t.points.map(function(t){return t[1]})),3===t.dimensions&&(o=l.extent(t.points.map(function(t){return t[2]})));var n=function(t){return Math.abs(t[1]-t[0])},r=n(e),s=n(i),a=n(o),c=Math.max(r,s,a),u=h.SCATTER_PLOT_CUBE_LENGTH/2,p=function(t,e){return[t/c*-e,e*(t/c)]},d=p(r,u),f=p(s,u),m=p(a,u),y=new Float32Array(3*t.points.length),v=0;return t.points.forEach(function(n,r){var s=t.points[r];y[v++]=l.scaleLinear(s[0],e,d),y[v++]=l.scaleLinear(s[1],i,f),3===t.dimensions?y[v++]=l.scaleLinear(s[2],o,m):y[v++]=0}),y},t.prototype.generateVisibleLabelRenderParams=function(t){var e=this.hoverPointIndex,i=this.selectedPointIndices,o=this.styles,n=i.length,r=n+(null!==e?1:0),a=new Uint32Array(r),h=new Float32Array(r),c=new Int8Array(r),u=new Uint8Array(3*r),p=new Uint8Array(3*r),d=[];h.fill(o.label.scaleDefault),c.fill(1);var f=0;if(null!==e){d.push(this.getLabelText(e)),a[f]=e,h[f]=o.label.scaleLarge,c[f]=0;var m=l.styleRgbFromHexColor(o.label.fillColorHover);l.packRgbIntoUint8Array(u,f,m[0],m[1],m[2]);var y=l.styleRgbFromHexColor(o.label.strokeColorHover);l.packRgbIntoUint8Array(p,f,y[0],y[1],y[1]),++f}for(var v=n,g=(m=l.styleRgbFromHexColor(o.label.fillColorSelected),y=l.styleRgbFromHexColor(o.label.strokeColorSelected),0);g<v;++g){var b=i[g];d.push(this.getLabelText(b)),a[f]=b,h[f]=o.label.scaleLarge,c[f]=1===v?0:1,l.packRgbIntoUint8Array(u,f,m[0],m[1],m[2]),l.packRgbIntoUint8Array(p,f,y[0],y[1],y[2]),++f}return new s.LabelRenderParams(new Float32Array(a),d,h,c,o.label.fontSize,u,p)},t.prototype.generatePointScaleFactorArray=function(t){var e=this.hoverPointIndex,i=this.selectedPointIndices,o=this.styles.point,n=o.scaleDefault,r=o.scaleSelected,s=o.scaleHover,a=new Float32Array(t.points.length);a.fill(n);for(var l=i.length,h=0;h<l;++h){a[i[h]]=r}return null!=e&&(a[e]=s),a},t.prototype.generatePointColorArray=function(t){var e=this.hoverPointIndex,i=this.pointColorer,o=this.selectedPointIndices,r=this.styles.point,s=r.colorHover,a=r.colorNoSelection,l=r.colorSelected,c=r.colorUnselected,u=o.length,p=new Float32Array(t.points.length*h.RGBA_NUM_ELEMENTS),d=c,f=a;"TEXT"===this.renderMode&&(d=this.styles.label3D.colorUnselected,f=this.styles.label3D.colorNoSelection),"SPRITE"===this.renderMode&&(d=this.styles.sprites.colorUnselected,f=this.styles.sprites.colorNoSelection);var m=t.points.length,y=0;if(u>0)for(var v=n.parseColor(d),g=0;g<m;++g)p[y++]=v.r,p[y++]=v.g,p[y++]=v.b,p[y++]=v.opacity;else if(i)for(g=0;g<m;++g){v=n.parseColor(i(g)||f);p[y++]=v.r,p[y++]=v.g,p[y++]=v.b,p[y++]=v.opacity}else for(v=n.parseColor(f),g=0;g<m;++g)p[y++]=v.r,p[y++]=v.g,p[y++]=v.b,p[y++]=v.opacity;for(m=u,v=n.parseColor(l),g=0;g<m;++g){y=o[g]*h.RGBA_NUM_ELEMENTS;p[y++]=v.r,p[y++]=v.g,p[y++]=v.b,p[y++]=v.opacity}if(null!=e){v=n.parseColor(s),y=e*h.RGBA_NUM_ELEMENTS;p[y++]=v.r,p[y++]=v.g,p[y++]=v.b,p[y++]=v.opacity}return p},t.prototype.generate3DLabelsArray=function(){var t=this.dataset;if(!t)return[];for(var e=[],i=t.points.length,o=0;o<i;++o)e.push(this.getLabelText(o));return e},t.prototype.generateLineSegmentColorMap=function(t){for(var e=this.pointColorer,i=this.styles,o={},r=0;r<this.sequences.length;r++){var s=this.sequences[r],a=new Float32Array(2*(s.indices.length-1)*3),h=0;if(e)for(var c=0;c<s.indices.length-1;c++){var u=n.parseColor(e(s.indices[c])),p=n.parseColor(e(s.indices[c+1]));a[h++]=u.r,a[h++]=u.g,a[h++]=u.b,a[h++]=p.r,a[h++]=p.g,a[h++]=p.b}else for(c=0;c<s.indices.length-1;c++){u=l.getDefaultPointInPolylineColor(c,s.indices.length,i.polyline.startHue,i.polyline.endHue,i.polyline.saturation,i.polyline.lightness),p=l.getDefaultPointInPolylineColor(c+1,s.indices.length,i.polyline.startHue,i.polyline.endHue,i.polyline.saturation,i.polyline.lightness);a[h++]=u.r,a[h++]=u.g,a[h++]=u.b,a[h++]=p.r,a[h++]=p.g,a[h++]=p.b}o[r]=a}return o},t.prototype.generateLineSegmentOpacityArray=function(t){var e=this.selectedPointIndices,i=this.styles,o=new Float32Array(this.sequences.length);if(e.length>0){o.fill(i.polyline.deselectedOpacity);var n=this.polylineVisualizer.getPointSequenceIndex(e[0]);void 0!==n&&(o[n]=i.polyline.selectedOpacity)}else o.fill(i.polyline.defaultOpacity);return o},t.prototype.generateLineSegmentWidthArray=function(t){var e=this.selectedPointIndices,i=this.styles,o=new Float32Array(this.sequences.length);if(o.fill(i.polyline.defaultLineWidth),e.length>0){var n=this.polylineVisualizer.getPointSequenceIndex(e[0]);void 0!==n&&(o[n]=i.polyline.selectedLineWidth)}return o},t.prototype.getLabelText=function(t){var e=this.dataset;if(!e)return"";var i=e.metadata[t];return i&&null!=i.label?""+i.label:""},t.prototype.initializeCanvasLabelsVisualizer=function(){return this.canvasLabelsVisualizer||(this.canvasLabelsVisualizer=new p.ScatterPlotVisualizerCanvasLabels(this.containerElement,this.styles)),this.canvasLabelsVisualizer},t.prototype.initialize3DLabelsVisualizer=function(){return this.labels3DVisualizer||(this.labels3DVisualizer=new c.ScatterPlotVisualizer3DLabels(this.styles)),this.labels3DVisualizer.setLabelStrings(this.generate3DLabelsArray()),this.labels3DVisualizer},t.prototype.initializePointVisualizer=function(){return this.pointVisualizer||(this.pointVisualizer=new u.ScatterPlotVisualizerSprites(this.styles)),this.pointVisualizer},t.prototype.initializeSpritesheetVisualizer=function(){var t=this,e=this.styles,i=this.dataset,o=i.spriteMetadata;if(!this.spritesheetVisualizer&&o){if(!o.spriteImage||!o.singleSpriteSize)return;for(var n=i.points.length,r=new Float32Array(n),s=0;s<n;++s)r[s]=s;var a=new u.ScatterPlotVisualizerSprites(e,{spritesheetImage:o.spriteImage,spriteDimensions:o.singleSpriteSize,spriteIndices:r,onImageLoad:function(){return t.renderScatterPlot()}});a.id="SPRITE_SHEET_VISUALIZER",this.spritesheetVisualizer=a}return this.spritesheetVisualizer},t.prototype.initializePolylineVisualizer=function(){return this.polylineVisualizer||(this.polylineVisualizer=new d.ScatterPlotVisualizerPolylines),this.polylineVisualizer.setSequences(this.sequences),this.polylineVisualizer},t.prototype.setVisualizers=function(){var t=this.dataset,e=this.renderMode,i=[];if("TEXT"===e){var o=this.initialize3DLabelsVisualizer();i.push(o)}else if("POINT"===e){o=this.initializePointVisualizer();i.push(o)}else if("SPRITE"===e&&t.spriteMetadata){(o=this.initializeSpritesheetVisualizer())&&i.push(o)}if(this.sequences.length>0){o=this.initializePolylineVisualizer();i.push(o)}if(("POINT"===e||"SPRITE"===e)&&this.showLabelsOnHover){o=this.initializeCanvasLabelsVisualizer();i.push(o)}this.scatterPlot.setActiveVisualizers(i)},t.Dataset=r.Dataset,t}();e.ScatterGL=f},function(t,e,i){"use strict";var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}},n=this&&this.__read||function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,n,r=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),s=i(7),a=i(2),l=i(1),h=i(8),c=new r.Vector3(.45,.9,1.6),u=new r.Vector3(0,0,0),p=new r.Vector3(0,0,4),d=new r.Vector3(0,0,0),f=function(){function t(t,e){var i=this;this.clickCallback=function(){},this.hoverCallback=function(){},this.selectCallback=function(){},this.selectEnabled=!0,this.visualizers=new Map,this.onCameraMoveListeners=[],this.height=0,this.width=0,this.dimensions=3,this.interactionMode="PAN",this.pickingTexture=new r.WebGLRenderTarget(0,0),this.orbitAnimationOnNextCameraCreation=!1,this.orbitAnimationId=null,this.worldSpacePointPositions=new Float32Array,this.pointColors=new Float32Array,this.pointScaleFactors=new Float32Array,this.polylineColors={},this.polylineOpacities=new Float32Array,this.polylineWidths=new Float32Array,this.selecting=!1,this.nearestPoint=null,this.mouseIsDown=!1,this.isDragSequence=!1,this.lastHovered=null,this.container=t,this.styles=e.styles,this.setParameters(e),this.computeLayoutValues(),this.scene=new r.Scene,this.renderer=new r.WebGLRenderer({alpha:!0,premultipliedAlpha:!1,antialias:!1}),this.renderer.setClearColor(this.styles.backgroundColor,1),this.container.appendChild(this.renderer.domElement),this.light=new r.PointLight(16772287,1,0),this.scene.add(this.light),this.rectangleSelector=new h.ScatterPlotRectangleSelector(this.container,function(t){return i.selectBoundingBox(t)},this.styles),this.addInteractionListeners(),this.setDimensions(3),this.makeCamera(e.camera),this.resize()}return t.prototype.setParameters=function(t){void 0!==t.onClick&&(this.clickCallback=t.onClick),void 0!==t.onHover&&(this.hoverCallback=t.onHover),void 0!==t.onSelect&&(this.selectCallback=t.onSelect),void 0!==t.selectEnabled&&(this.selectEnabled=t.selectEnabled)},t.prototype.addInteractionListeners=function(){this.container.addEventListener("mousemove",this.onMouseMove.bind(this)),this.container.addEventListener("mousedown",this.onMouseDown.bind(this)),this.container.addEventListener("mouseup",this.onMouseUp.bind(this)),this.container.addEventListener("click",this.onClick.bind(this)),window.addEventListener("keydown",this.onKeyDown.bind(this),!1),window.addEventListener("keyup",this.onKeyUp.bind(this),!1)},t.prototype.addCameraControlsEventListeners=function(t){var e=this;t.addEventListener("start",function(){e.stopOrbitAnimation(),e.onCameraMoveListeners.forEach(function(i){return i(e.camera.position,t.target)})}),t.addEventListener("change",function(){e.render()}),t.addEventListener("end",function(){})},t.prototype.makeOrbitControls=function(t,e){null!=this.orbitCameraControls&&this.orbitCameraControls.dispose();var i=new s.OrbitControls(t,this.renderer.domElement);i.zoomSpeed=.125,i.enableRotate=e,i.autoRotate=!1,i.rotateSpeed=1,e?(i.mouseButtons.ORBIT=r.MOUSE.LEFT,i.mouseButtons.PAN=r.MOUSE.RIGHT):(i.mouseButtons.ORBIT=r.MOUSE.RIGHT,i.mouseButtons.PAN=r.MOUSE.LEFT),i.reset(),this.camera=t,this.orbitCameraControls=i,this.addCameraControlsEventListeners(this.orbitCameraControls)},t.prototype.makeCamera=function(t){void 0===t&&(t={});var e=this.makeDefaultCameraDef(this.dimensions,t);this.recreateCamera(e),3===this.dimensions&&this.styles.axesVisible?this.add3dAxes():this.remove3dAxesFromScene()},t.prototype.makeCamera3D=function(t,e,i){var o,n=e/i;(o=new r.PerspectiveCamera(70,n,.01,100)).position.set(t.position[0],t.position[1],t.position[2]);var s=new r.Vector3(t.target[0],t.target[1],t.target[2]);o.lookAt(s),o.zoom=t.zoom,o.updateProjectionMatrix(),this.camera=o,this.makeOrbitControls(o,!0)},t.prototype.makeCamera2D=function(t,e,i){var o,n=new r.Vector3(t.target[0],t.target[1],t.target[2]),s=e/i,a=-1.2,l=1.2,h=-1.2,c=1.2;s>1?(a*=s,l*=s):(c/=s,h/=s),(o=new r.OrthographicCamera(a,l,c,h,-1e3,1e3)).position.set(t.position[0],t.position[1],t.position[2]),o.up=new r.Vector3(0,0,1),o.lookAt(n),o.zoom=t.zoom,o.updateProjectionMatrix(),this.camera=o,this.makeOrbitControls(o,!1)},t.prototype.makeDefaultCameraDef=function(t,e){void 0===e&&(e={});var i=2===t,o=i?p:c,n=i?d:u,r={orthographic:i,zoom:1,position:[o.x,o.y,o.z],target:[n.x,n.y,n.z]};return e.zoom&&(r.zoom=e.zoom),e.position&&(r.position=e.position),e.target&&(r.target=e.target),r},t.prototype.recreateCamera=function(t){t.orthographic?this.makeCamera2D(t,this.width,this.height):this.makeCamera3D(t,this.width,this.height),this.orbitCameraControls.minDistance=.05,this.orbitCameraControls.maxDistance=10,this.orbitCameraControls.update(),this.orbitAnimationOnNextCameraCreation&&this.startOrbitAnimation()},t.prototype.setInteractionMode=function(t){this.interactionMode=t,"SELECT"===t?(this.selecting=!0,this.container.style.cursor="crosshair"):(this.selecting=!1,this.container.style.cursor="default")},t.prototype.onClick=function(t,e){if(void 0===e&&(e=!0),!t||!this.selecting){if(!this.isDragSequence&&e){var i=null!=this.nearestPoint?[this.nearestPoint]:[];this.selectCallback(i),this.clickCallback(this.nearestPoint)}this.isDragSequence=!1,this.render()}},t.prototype.onMouseDown=function(t){this.isDragSequence=!1,this.mouseIsDown=!0,this.selecting?(this.orbitCameraControls.enabled=!1,this.rectangleSelector.onMouseDown(t.offsetX,t.offsetY),this.setNearestPointToMouse(t)):!t.ctrlKey&&this.sceneIs3D()&&this.orbitCameraControls.mouseButtons.ORBIT===r.MOUSE.RIGHT?(this.orbitCameraControls.mouseButtons.ORBIT=r.MOUSE.LEFT,this.orbitCameraControls.mouseButtons.PAN=r.MOUSE.RIGHT):t.ctrlKey&&this.sceneIs3D()&&this.orbitCameraControls.mouseButtons.ORBIT===r.MOUSE.LEFT&&(this.orbitCameraControls.mouseButtons.ORBIT=r.MOUSE.RIGHT,this.orbitCameraControls.mouseButtons.PAN=r.MOUSE.LEFT)},t.prototype.onMouseUp=function(t){this.selecting&&(this.orbitCameraControls.enabled=!0,this.rectangleSelector.onMouseUp(),this.render()),this.mouseIsDown=!1},t.prototype.onMouseMove=function(t){this.isDragSequence=this.mouseIsDown,this.selecting&&this.mouseIsDown?(this.rectangleSelector.onMouseMove(t.offsetX,t.offsetY),this.render()):this.mouseIsDown||(this.setNearestPointToMouse(t),this.nearestPoint!=this.lastHovered&&(this.lastHovered=this.nearestPoint,this.hoverCallback(this.nearestPoint)))},t.prototype.onKeyDown=function(t){17===t.keyCode&&this.sceneIs3D()&&(this.orbitCameraControls.mouseButtons.ORBIT=r.MOUSE.RIGHT,this.orbitCameraControls.mouseButtons.PAN=r.MOUSE.LEFT),16===t.keyCode&&this.selectEnabled&&(this.selecting=!0,this.container.style.cursor="crosshair")},t.prototype.onKeyUp=function(t){17===t.keyCode&&this.sceneIs3D()&&(this.orbitCameraControls.mouseButtons.ORBIT=r.MOUSE.LEFT,this.orbitCameraControls.mouseButtons.PAN=r.MOUSE.RIGHT),16===t.keyCode&&this.selectEnabled&&(this.selecting=!1,this.container.style.cursor="default",this.render())},t.prototype.getPointIndicesFromPickingTexture=function(t){if(null==this.worldSpacePointPositions)return[];var e=this.worldSpacePointPositions.length/3,i=window.devicePixelRatio||1,o=Math.floor(t.x*i),n=Math.floor(t.y*i),r=Math.max(Math.floor(t.width*i),1),s=Math.max(Math.floor(t.height*i),1),a=new Uint8Array(r*s*4);this.renderer.readRenderTargetPixels(this.pickingTexture,o,this.pickingTexture.height-n,r,s,a);for(var l=new Uint8Array(this.worldSpacePointPositions.length),h=0;h<r*s;h++){var c=a[4*h]<<16|a[4*h+1]<<8|a[4*h+2];16777215!==c&&c<e&&(l[c]=1)}var u=[];for(h=0;h<l.length;h++)1===l[h]&&u.push(h);return u},t.prototype.selectBoundingBox=function(t){var e=this.getPointIndicesFromPickingTexture(t);this.selectCallback(e)},t.prototype.setNearestPointToMouse=function(t){if(null!=this.pickingTexture){var e={x:t.offsetX,y:t.offsetY,width:1,height:1},i=this.getPointIndicesFromPickingTexture(e);this.nearestPoint=i.length?i[0]:null}else this.nearestPoint=null},t.prototype.computeLayoutValues=function(){return this.width=this.container.offsetWidth,this.height=Math.max(1,this.container.offsetHeight),[this.width,this.height]},t.prototype.sceneIs3D=function(){return 3===this.dimensions},t.prototype.remove3dAxesFromScene=function(){var t=this.scene.getObjectByName("axes");return null!=t&&this.scene.remove(t),t},t.prototype.add3dAxes=function(){var t=new r.AxesHelper;t.name="axes",this.scene.add(t)},t.prototype.setDimensions=function(t){if(2!==t&&3!==t)throw new RangeError("dimensions must be 2 or 3");this.dimensions!==t&&(this.dimensions=t,this.makeCamera())},t.prototype.getCameraPosition=function(){var t=this.camera.position;return[t.x,t.y,t.z]},t.prototype.getCameraTarget=function(){var t=this.orbitCameraControls.target;return[t.x,t.y,t.z]},t.prototype.setCameraPositionAndTarget=function(t,e){this.stopOrbitAnimation(),this.camera.position.set(t[0],t[1],t[2]),this.orbitCameraControls.target.set(e[0],e[1],e[2]),this.orbitCameraControls.update(),this.render()},t.prototype.startOrbitAnimation=function(){this.sceneIs3D()&&(null!=this.orbitAnimationId&&this.stopOrbitAnimation(),this.orbitCameraControls.autoRotate=!0,this.orbitCameraControls.rotateSpeed=7,this.updateOrbitAnimation())},t.prototype.orbitIsAnimating=function(){return null!=this.orbitAnimationId},t.prototype.updateOrbitAnimation=function(){var t=this;this.orbitCameraControls.update(),this.orbitAnimationId=requestAnimationFrame(function(){return t.updateOrbitAnimation()})},t.prototype.stopOrbitAnimation=function(){this.orbitCameraControls.autoRotate=!1,this.orbitCameraControls.rotateSpeed=1,null!=this.orbitAnimationId&&(cancelAnimationFrame(this.orbitAnimationId),this.orbitAnimationId=null)},t.prototype.setActiveVisualizers=function(t){var e,i,n,r,s=new Set(t.map(function(t){return t.id}));try{for(var a=o(this.visualizers.values()),l=a.next();!l.done;l=a.next()){var h=l.value;s.has(h.id)||(h.dispose(),this.visualizers.delete(h.id))}}catch(t){e={error:t}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}try{for(var c=o(t),u=c.next();!u.done;u=c.next()){h=u.value;this.visualizers.set(h.id,h),h.setScene(this.scene),h.onResize(this.width,this.height),this.worldSpacePointPositions&&h.onPointPositionsChanged(this.worldSpacePointPositions)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}},t.prototype.disposeAllVisualizers=function(){this.visualizers.forEach(function(t){return t.dispose()}),this.visualizers.clear()},t.prototype.setPointPositions=function(t){this.worldSpacePointPositions=t,this.visualizers.forEach(function(e){return e.onPointPositionsChanged(t)})},t.prototype.render=function(){var t=this.camera.position.clone();t.x+=1,t.y+=1,this.light.position.set(t.x,t.y,t.z);var e=this.camera instanceof r.PerspectiveCamera?a.CameraType.Perspective:a.CameraType.Orthographic,i=[0,0];null!=this.worldSpacePointPositions&&(i=l.getNearFarPoints(this.worldSpacePointPositions,this.camera.position,this.orbitCameraControls.target));var o=new a.RenderContext(this.camera,e,this.orbitCameraControls.target,this.width,this.height,i[0],i[1],this.styles.backgroundColor,this.pointColors,this.pointScaleFactors,this.labels,this.polylineColors,this.polylineOpacities,this.polylineWidths);this.visualizers.forEach(function(t){return t.onPickingRender(o)});var n=this.remove3dAxesFromScene();this.renderer.setRenderTarget(this.pickingTexture),this.renderer.render(this.scene,this.camera),null!=n&&this.scene.add(n),this.visualizers.forEach(function(t){return t.onRender(o)}),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera)},t.prototype.setPointColors=function(t){this.pointColors=t},t.prototype.setPointScaleFactors=function(t){this.pointScaleFactors=t},t.prototype.setLabels=function(t){this.labels=t},t.prototype.setPolylineColors=function(t){this.polylineColors=t},t.prototype.setPolylineOpacities=function(t){this.polylineOpacities=t},t.prototype.setPolylineWidths=function(t){this.polylineWidths=t},t.prototype.resetZoom=function(){this.recreateCamera(this.makeDefaultCameraDef(this.dimensions)),this.render()},t.prototype.setDayNightMode=function(t){for(var e=this.container.querySelectorAll("canvas"),i=t?"invert(100%)":"",o=0;o<e.length;o++)e[o].style.filter=i},t.prototype.resize=function(t){void 0===t&&(t=!0);var e=n([this.width,this.height],2),i=e[0],o=e[1],s=n(this.computeLayoutValues(),2),a=s[0],l=s[1];if(3===this.dimensions){(h=this.camera).aspect=a/l,h.updateProjectionMatrix()}else{var h=this.camera,c=a/i,u=l/o,p=(h.right-h.left)*c/2,d=(h.top-h.bottom)*u/2;h.top=d,h.bottom=-d,h.left=-p,h.right=p,h.updateProjectionMatrix()}var f=window.devicePixelRatio||1;this.renderer.setPixelRatio(f),this.renderer.setSize(a,l);var m=new r.Vector2;this.renderer.getSize(m);var y=this.renderer.getPixelRatio();this.pickingTexture=new r.WebGLRenderTarget(m.width*y,m.height*y),this.pickingTexture.texture.minFilter=r.LinearFilter,this.visualizers.forEach(function(t){return t.onResize(a,l)}),t&&this.render()},t.prototype.onCameraMove=function(t){this.onCameraMoveListeners.push(t)},t.prototype.clickOnPoint=function(t){this.nearestPoint=t,this.onClick(null,!1)},t}();e.ScatterPlot=f},function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},a={type:"change"},l={type:"start"},h={type:"end"},c=function(t){function e(e,i,o){var n=t.call(this)||this;return n.object=e,n.domElement=void 0!==i?i:document,n.window=void 0!==o?o:window,n.enabled=!0,n.target=new r.Vector3,n.minDistance=0,n.maxDistance=1/0,n.minZoom=0,n.maxZoom=1/0,n.minPolarAngle=0,n.maxPolarAngle=Math.PI,n.minAzimuthAngle=-1/0,n.maxAzimuthAngle=1/0,n.enableDamping=!1,n.dampingFactor=.25,n.enableZoom=!0,n.zoomSpeed=1,n.enableRotate=!0,n.rotateSpeed=1,n.enablePan=!0,n.keyPanSpeed=7,n.autoRotate=!1,n.autoRotateSpeed=2,n.enableKeys=!0,n.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},n.mouseButtons={ORBIT:r.MOUSE.LEFT,ZOOM:r.MOUSE.MIDDLE,PAN:r.MOUSE.RIGHT},n.target0=n.target.clone(),n.position0=n.object.position.clone(),n.zoom0=n.object.zoom,n.updateOffset=new r.Vector3,n.updateQuat=(new r.Quaternion).setFromUnitVectors(e.up,new r.Vector3(0,1,0)),n.updateQuatInverse=n.updateQuat.clone().inverse(),n.updateLastPosition=new r.Vector3,n.updateLastQuaternion=new r.Quaternion,n.state=s.NONE,n.scale=1,n.spherical=new r.Spherical,n.sphericalDelta=new r.Spherical,n.panOffset=new r.Vector3,n.zoomChanged=!1,n.rotateStart=new r.Vector2,n.rotateEnd=new r.Vector2,n.rotateDelta=new r.Vector2,n.panStart=new r.Vector2,n.panEnd=new r.Vector2,n.panDelta=new r.Vector2,n.dollyStart=new r.Vector2,n.dollyEnd=new r.Vector2,n.dollyDelta=new r.Vector2,n.panLeftV=new r.Vector3,n.panUpV=new r.Vector3,n.panInternalOffset=new r.Vector3,n.onMouseDown=function(t){if(!1!==n.enabled){if(t.preventDefault(),t.button===n.mouseButtons.ORBIT){if(!1===n.enableRotate)return;n.rotateStart.set(t.clientX,t.clientY),n.state=s.ROTATE}else if(t.button===n.mouseButtons.ZOOM){if(!1===n.enableZoom)return;n.dollyStart.set(t.clientX,t.clientY),n.state=s.DOLLY}else if(t.button===n.mouseButtons.PAN){if(!1===n.enablePan)return;n.panStart.set(t.clientX,t.clientY),n.state=s.PAN}n.state!==s.NONE&&(document.addEventListener("mousemove",n.onMouseMove,!1),document.addEventListener("mouseup",n.onMouseUp,!1),n.dispatchEvent(l))}},n.onMouseMove=function(t){if(!1!==n.enabled)if(t.preventDefault(),n.state===s.ROTATE){if(!1===n.enableRotate)return;n.rotateEnd.set(t.clientX,t.clientY),n.rotateDelta.subVectors(n.rotateEnd,n.rotateStart);var e=n.domElement===document?n.domElement.body:n.domElement;n.rotateLeft(2*Math.PI*n.rotateDelta.x/e.clientWidth*n.rotateSpeed),n.rotateUp(2*Math.PI*n.rotateDelta.y/e.clientHeight*n.rotateSpeed),n.rotateStart.copy(n.rotateEnd),n.update()}else if(n.state===s.DOLLY){if(!1===n.enableZoom)return;n.dollyEnd.set(t.clientX,t.clientY),n.dollyDelta.subVectors(n.dollyEnd,n.dollyStart),n.dollyDelta.y>0?n.dollyIn(n.getZoomScale()):n.dollyDelta.y<0&&n.dollyOut(n.getZoomScale()),n.dollyStart.copy(n.dollyEnd),n.update()}else if(n.state===s.PAN){if(!1===n.enablePan)return;n.panEnd.set(t.clientX,t.clientY),n.panDelta.subVectors(n.panEnd,n.panStart),n.pan(n.panDelta.x,n.panDelta.y),n.panStart.copy(n.panEnd),n.update()}},n.onMouseUp=function(t){!1!==n.enabled&&(document.removeEventListener("mousemove",n.onMouseMove,!1),document.removeEventListener("mouseup",n.onMouseUp,!1),n.dispatchEvent(h),n.state=s.NONE)},n.onMouseWheel=function(t){!1===n.enabled||!1===n.enableZoom||n.state!==s.NONE&&n.state!==s.ROTATE||(t.preventDefault(),t.stopPropagation(),t.deltaY<0?n.dollyOut(n.getZoomScale()):t.deltaY>0&&n.dollyIn(n.getZoomScale()),n.update(),n.dispatchEvent(l),n.dispatchEvent(h))},n.onKeyDown=function(t){if(!1!==n.enabled&&!1!==n.enableKeys&&!1!==n.enablePan)switch(t.keyCode){case n.keys.UP:n.pan(0,n.keyPanSpeed),n.update();break;case n.keys.BOTTOM:n.pan(0,-n.keyPanSpeed),n.update();break;case n.keys.LEFT:n.pan(n.keyPanSpeed,0),n.update();break;case n.keys.RIGHT:n.pan(-n.keyPanSpeed,0),n.update()}},n.onTouchStart=function(t){if(!1!==n.enabled){switch(t.touches.length){case 1:if(!1===n.enableRotate)return;n.rotateStart.set(t.touches[0].pageX,t.touches[0].pageY),n.state=s.TOUCH_ROTATE;break;case 2:if(!1===n.enableZoom)return;var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,o=Math.sqrt(e*e+i*i);n.dollyStart.set(0,o),n.state=s.TOUCH_DOLLY;break;case 3:if(!1===n.enablePan)return;n.panStart.set(t.touches[0].pageX,t.touches[0].pageY),n.state=s.TOUCH_PAN;break;default:n.state=s.NONE}n.state!==s.NONE&&n.dispatchEvent(l)}},n.onTouchMove=function(t){if(!1!==n.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(!1===n.enableRotate)return;if(n.state!==s.TOUCH_ROTATE)return;n.rotateEnd.set(t.touches[0].pageX,t.touches[0].pageY),n.rotateDelta.subVectors(n.rotateEnd,n.rotateStart);var e=n.domElement===document?n.domElement.body:n.domElement;n.rotateLeft(2*Math.PI*n.rotateDelta.x/e.clientWidth*n.rotateSpeed),n.rotateUp(2*Math.PI*n.rotateDelta.y/e.clientHeight*n.rotateSpeed),n.rotateStart.copy(n.rotateEnd),n.update();break;case 2:if(!1===n.enableZoom)return;if(n.state!==s.TOUCH_DOLLY)return;var i=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(i*i+o*o);n.dollyEnd.set(0,r),n.dollyDelta.subVectors(n.dollyEnd,n.dollyStart),n.dollyDelta.y>0?n.dollyOut(n.getZoomScale()):n.dollyDelta.y<0&&n.dollyIn(n.getZoomScale()),n.dollyStart.copy(n.dollyEnd),n.update();break;case 3:if(!1===n.enablePan)return;if(n.state!==s.TOUCH_PAN)return;n.panEnd.set(t.touches[0].pageX,t.touches[0].pageY),n.panDelta.subVectors(n.panEnd,n.panStart),n.pan(n.panDelta.x,n.panDelta.y),n.panStart.copy(n.panEnd),n.update();break;default:n.state=s.NONE}},n.onTouchEnd=function(t){!1!==n.enabled&&(n.dispatchEvent(h),n.state=s.NONE)},n.onContextMenu=function(t){t.preventDefault()},n.domElement.addEventListener("contextmenu",n.onContextMenu,!1),n.domElement.addEventListener("mousedown",n.onMouseDown,!1),n.domElement.addEventListener("wheel",n.onMouseWheel,!1),n.domElement.addEventListener("touchstart",n.onTouchStart,!1),n.domElement.addEventListener("touchend",n.onTouchEnd,!1),n.domElement.addEventListener("touchmove",n.onTouchMove,!1),n.window.addEventListener("keydown",n.onKeyDown,!1),n.update(),n}return n(e,t),e.prototype.update=function(){var t=this.object.position;return this.updateOffset.copy(t).sub(this.target),this.updateOffset.applyQuaternion(this.updateQuat),this.spherical.setFromVector3(this.updateOffset),this.autoRotate&&this.state===s.NONE&&this.rotateLeft(this.getAutoRotationAngle()),this.spherical.theta+=this.sphericalDelta.theta,this.spherical.phi+=this.sphericalDelta.phi,this.spherical.theta=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,this.spherical.theta)),this.spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this.spherical.phi)),this.spherical.makeSafe(),this.spherical.radius*=this.scale,this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius)),this.target.add(this.panOffset),this.updateOffset.setFromSpherical(this.spherical),this.updateOffset.applyQuaternion(this.updateQuatInverse),t.copy(this.target).add(this.updateOffset),this.object.lookAt(this.target),!0===this.enableDamping?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor):this.sphericalDelta.set(0,0,0),this.scale=1,this.panOffset.set(0,0,0),!!(this.zoomChanged||this.updateLastPosition.distanceToSquared(this.object.position)>1e-6||8*(1-this.updateLastQuaternion.dot(this.object.quaternion))>1e-6)&&(this.dispatchEvent(a),this.updateLastPosition.copy(this.object.position),this.updateLastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0)},e.prototype.panLeft=function(t,e){this.panLeftV.setFromMatrixColumn(e,0),this.panLeftV.multiplyScalar(-t),this.panOffset.add(this.panLeftV)},e.prototype.panUp=function(t,e){this.panUpV.setFromMatrixColumn(e,1),this.panUpV.multiplyScalar(t),this.panOffset.add(this.panUpV)},e.prototype.pan=function(t,e){var i=this.domElement===document?this.domElement.body:this.domElement;if(this._checkPerspectiveCamera(this.object)){var o=this.object.position;this.panInternalOffset.copy(o).sub(this.target);var n=this.panInternalOffset.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*t*n/i.clientHeight,this.object.matrix),this.panUp(2*e*n/i.clientHeight,this.object.matrix)}else this._checkOrthographicCamera(this.object)?(this.panLeft(t*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this.panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)},e.prototype.dollyIn=function(t){this._checkPerspectiveCamera(this.object)?this.scale/=t:this._checkOrthographicCamera(this.object)?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),this.object.updateProjectionMatrix(),this.zoomChanged=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)},e.prototype.dollyOut=function(t){this._checkPerspectiveCamera(this.object)?this.scale*=t:this._checkOrthographicCamera(this.object)?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),this.object.updateProjectionMatrix(),this.zoomChanged=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)},e.prototype.getAutoRotationAngle=function(){return 2*Math.PI/60/60*this.autoRotateSpeed},e.prototype.getZoomScale=function(){return Math.pow(.95,this.zoomSpeed)},e.prototype.rotateLeft=function(t){this.sphericalDelta.theta-=t},e.prototype.rotateUp=function(t){this.sphericalDelta.phi-=t},e.prototype.getPolarAngle=function(){return this.spherical.phi},e.prototype.getAzimuthalAngle=function(){return this.spherical.theta},e.prototype.dispose=function(){this.domElement.removeEventListener("contextmenu",this.onContextMenu,!1),this.domElement.removeEventListener("mousedown",this.onMouseDown,!1),this.domElement.removeEventListener("wheel",this.onMouseWheel,!1),this.domElement.removeEventListener("touchstart",this.onTouchStart,!1),this.domElement.removeEventListener("touchend",this.onTouchEnd,!1),this.domElement.removeEventListener("touchmove",this.onTouchMove,!1),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),this.window.removeEventListener("keydown",this.onKeyDown,!1)},e.prototype.reset=function(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(a),this.update(),this.state=s.NONE},e.prototype.saveState=function(){this.target0.copy(this.target),this.position0.copy(this.object.position),(this._checkOrthographicCamera(this.object)||this._checkPerspectiveCamera(this.object))&&(this.zoom0=this.object.zoom)},Object.defineProperty(e.prototype,"center",{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noZoom",{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t},enumerable:!0,configurable:!0}),e.prototype._checkPerspectiveCamera=function(t){return t.isPerspectiveCamera},e.prototype._checkOrthographicCamera=function(t){return t.isOrthographicCamera},e}(r.EventDispatcher);e.OrbitControls=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e,i){this.startCoordinates=[0,0],this.svgElement=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgElement.style.display="none",this.svgElement.style.height="100%",this.svgElement.style.width="100%",this.svgElement.style.position="absolute",t.insertAdjacentElement("afterbegin",this.svgElement),this.rectElement=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.rectElement.style.stroke=i.select.stroke,this.rectElement.style.strokeDasharray=i.select.strokeDashArray,this.rectElement.style.strokeWidth=""+i.select.strokeWidth,this.rectElement.style.fill=i.select.fill,this.rectElement.style.fillOpacity=""+i.select.fillOpacity,this.svgElement.appendChild(this.rectElement),this.selectionCallback=e,this.isMouseDown=!1}return t.prototype.onMouseDown=function(t,e){this.isMouseDown=!0,this.rectElement.style.display="block",this.svgElement.style.display="block",this.startCoordinates=[t,e],this.lastBoundingBox={x:this.startCoordinates[0],y:this.startCoordinates[1],width:1,height:1}},t.prototype.onMouseMove=function(t,e){this.isMouseDown&&(this.lastBoundingBox.x=Math.min(t,this.startCoordinates[0]),this.lastBoundingBox.y=Math.max(e,this.startCoordinates[1]),this.lastBoundingBox.width=Math.max(t,this.startCoordinates[0])-this.lastBoundingBox.x,this.lastBoundingBox.height=this.lastBoundingBox.y-Math.min(e,this.startCoordinates[1]),this.rectElement.setAttribute("x",""+this.lastBoundingBox.x),this.rectElement.setAttribute("y",""+(this.lastBoundingBox.y-this.lastBoundingBox.height)),this.rectElement.setAttribute("width",""+this.lastBoundingBox.width),this.rectElement.setAttribute("height",""+this.lastBoundingBox.height))},t.prototype.onMouseUp=function(){this.isMouseDown=!1,this.svgElement.style.display="none",this.rectElement.style.display="none",this.rectElement.setAttribute("width","0"),this.rectElement.setAttribute("height","0"),this.selectionCallback(this.lastBoundingBox)},t}();e.ScatterPlotRectangleSelector=o},function(t,e,i){"use strict";var o=this&&this.__read||function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,n,r=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=new Map,s=/^(rgba|hsla)\((\d+),\s*(\d+%?),\s*(\d+%?)(?:,\s*(\d+(?:\.\d+)?))?\)$/;e.parseColor=function(t){if(r.has(t))return r.get(t);var e=function(t){var e=s.exec(t);if(e){var i=o(e,6),n=(i[0],i[1]),r=i[2],a=i[3],l=i[4],h=i[5];return{colorString:n.replace("a","")+"("+r+","+a+","+l+")",opacity:parseFloat(h)}}return{colorString:t,opacity:1}}(t),i=e.colorString,a=e.opacity,l=new n.Color(i),h={r:l.r,g:l.g,b:l.b,opacity:a};return r.set(t,h),h}},function(t,e,i){"use strict";var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var n="Points must be an array of either 2 or 3 dimensional number arrays",r=function(){function t(t,e){var i,r;void 0===e&&(e=[]),this.points=t,this.metadata=e;var s=t[0].length;if(2!==s&&3!==s)throw new Error(n);try{for(var a=o(t),l=a.next();!l.done;l=a.next()){if(s!==l.value.length)throw new Error(n)}}catch(t){i={error:t}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}this.dimensions=s}return t.prototype.setSpriteMetadata=function(t){this.spriteMetadata=t},t}();e.Dataset=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){return{backgroundColor:"#ffffff",axesVisible:!0,fog:{color:"#ffffff",enabled:!0,threshold:5e3},label:{fontSize:10,scaleDefault:1,scaleLarge:2,fillColorSelected:"#000000",fillColorHover:"#000000",strokeColorSelected:"#ffffff",strokeColorHover:"#ffffff",strokeWidth:3,fillWidth:6},label3D:{fontSize:80,scale:2.2,color:"black",backgroundColor:"#ffffff",colorUnselected:"#ffffff",colorNoSelection:"#ffffff"},point:{colorUnselected:"rgba(227, 227, 227, 0.7)",colorNoSelection:"rgba(117, 117, 217, 0.7)",colorSelected:"rgba(250, 102, 102, 0.7)",colorHover:"rgba(118, 11, 79, 0.7)",scaleDefault:1,scaleSelected:1.2,scaleHover:1.2},polyline:{startHue:60,endHue:360,saturation:1,lightness:.3,defaultOpacity:.2,defaultLineWidth:2,selectedOpacity:.9,selectedLineWidth:3,deselectedOpacity:.05},select:{fill:"#dddddd",fillOpacity:.2,stroke:"#aaaaaa",strokeWidth:2,strokeDashArray:"10 5"},sprites:{minPointSize:5,imageSize:30,colorUnselected:"#ffffff",colorNoSelection:"#ffffff"}}};e.makeStyles=function(t){var e=o();if(void 0===t)return e;for(var i in e){var n=i;"object"==typeof e[n]&&"object"==typeof t[n]?e[n]=Object.assign(e[n],t[n]):void 0!==t[n]&&(e[n]=t[n])}return e}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),n=i(1),r=i(3),s=function(t,e){return"\n      attribute vec2 posObj;\n      attribute vec4 color;\n      varying vec2 vUv;\n      varying vec4 vColor;\n\n      void main() {\n        vUv = uv;\n        vColor = color;\n\n        // Rotate label to face camera.\n\n        vec4 vRight = vec4(\n          modelViewMatrix[0][0], modelViewMatrix[1][0], modelViewMatrix[2][0], 0);\n\n        vec4 vUp = vec4(\n          modelViewMatrix[0][1], modelViewMatrix[1][1], modelViewMatrix[2][1], 0);\n\n        vec4 vAt = -vec4(\n          modelViewMatrix[0][2], modelViewMatrix[1][2], modelViewMatrix[2][2], 0);\n\n        mat4 pointToCamera = mat4(vRight, vUp, vAt, vec4(0, 0, 0, 1));\n\n        vec2 scaledPos = posObj * "+1/t+" * "+e+";\n\n        vec4 posRotated = pointToCamera * vec4(scaledPos, 0, 1);\n        vec4 mvPosition = modelViewMatrix * (vec4(position, 0) + posRotated);\n        gl_Position = projectionMatrix * mvPosition;\n      }"},a=function(){function t(t){this.styles=t,this.id="3D_LABELS",this.labelStrings=[],this.worldSpacePointPositions=new Float32Array,this.pickingColors=new Float32Array,this.renderColors=new Float32Array,this.uniforms={},this.totalVertexCount=0,this.labelVertexMap=[]}return t.prototype.createGlyphTexture=function(){var t=this.styles.label3D,e=t.fontSize,i=t.backgroundColor,o=t.color,r=document.createElement("canvas");r.width=8192,r.height=e;var s=r.getContext("2d");s.font="bold "+e+"px roboto",s.textBaseline="top",s.fillStyle=i,s.rect(0,0,r.width,r.height),s.fill(),s.fillStyle=o;for(var a=s.measureText(" ").width,l=new Float32Array(256),h=new Float32Array(256),c=0,u=0;u<256;u++){var p=" "+String.fromCharCode(u),d=s.measureText(p).width;l[u]=d-a,h[u]=c,s.fillText(p,c-a,0),c+=d}return{texture:n.createTextureFromCanvas(r),lengths:l,offsets:h}},t.prototype.processLabelVerts=function(t){var e=0;this.labelVertexMap=[];for(var i=0;i<t;i++){for(var o=this.labelStrings[i],n=[],r=0;r<o.length;r++){for(var s=0;s<6;s++)n.push(6*e+s);e++}this.labelVertexMap.push(n)}this.totalVertexCount=6*e},t.prototype.createColorBuffers=function(t){var e=this;this.pickingColors=new Float32Array(this.totalVertexCount*r.RGB_NUM_ELEMENTS),this.renderColors=new Float32Array(this.totalVertexCount*r.RGB_NUM_ELEMENTS);for(var i=function(t){var i=new o.Color(t);n.labelVertexMap[t].forEach(function(t){e.pickingColors[r.RGB_NUM_ELEMENTS*t]=i.r,e.pickingColors[r.RGB_NUM_ELEMENTS*t+1]=i.g,e.pickingColors[r.RGB_NUM_ELEMENTS*t+2]=i.b,e.renderColors[r.RGB_NUM_ELEMENTS*t]=1,e.renderColors[r.RGB_NUM_ELEMENTS*t+1]=1,e.renderColors[r.RGB_NUM_ELEMENTS*t+2]=1})},n=this,s=0;s<t;s++)i(s)},t.prototype.createLabels=function(){var t=this,e=this.styles.label3D,i=e.fontSize,a=e.scale;if(null!=this.labelStrings&&null!=this.worldSpacePointPositions){var l=this.worldSpacePointPositions.length/r.XYZ_NUM_ELEMENTS;if(l===this.labelStrings.length){this.glyphTexture=this.createGlyphTexture(),this.uniforms={texture:{type:"t"},picking:{type:"bool"}},this.material=new o.ShaderMaterial({uniforms:this.uniforms,transparent:!0,vertexShader:s(i,a),fragmentShader:"\n      uniform sampler2D texture;\n      uniform bool picking;\n      varying vec2 vUv;\n      varying vec4 vColor;\n\n      void main() {\n        if (picking) {\n          gl_FragColor = vColor;\n        } else {\n          vec4 fromTexture = texture2D(texture, vUv);\n          gl_FragColor = vColor * fromTexture;\n        }\n      }"}),this.processLabelVerts(l),this.createColorBuffers(l);var h=new Float32Array(this.totalVertexCount*r.XYZ_NUM_ELEMENTS);this.positions=new o.BufferAttribute(h,r.XYZ_NUM_ELEMENTS);var c=new Float32Array(this.totalVertexCount*r.XYZ_NUM_ELEMENTS),u=new Float32Array(this.totalVertexCount*r.UV_NUM_ELEMENTS),p=new Float32Array(this.totalVertexCount*r.RGB_NUM_ELEMENTS),d=new o.BufferAttribute(c,2),f=new o.BufferAttribute(u,r.UV_NUM_ELEMENTS),m=new o.BufferAttribute(p,r.RGB_NUM_ELEMENTS);this.geometry=new o.BufferGeometry,this.geometry.addAttribute("posObj",d),this.geometry.addAttribute("position",this.positions),this.geometry.addAttribute("uv",f),this.geometry.addAttribute("color",m);for(var y=0,v=0;v<l;v++){for(var g=this.labelStrings[v],b=0,S=0;S<g.length;S++){var P=g.charCodeAt(S);b+=this.glyphTexture.lengths[P]}b/=-2;for(S=0;S<g.length;S++){P=g.charCodeAt(S);var C=this.glyphTexture.lengths[P],E=(b+C)/i,M=b/i,w=i/i;d.setXY(6*y+0,M,0),d.setXY(6*y+1,E,0),d.setXY(6*y+2,M,w),d.setXY(6*y+3,M,w),d.setXY(6*y+4,E,0),d.setXY(6*y+5,E,w);var x=this.glyphTexture.offsets[P],A=this.glyphTexture.offsets[P]+C;x/=8192,A/=8192;f.setXY(6*y+0,x,1),f.setXY(6*y+1,A,1),f.setXY(6*y+2,x,0),f.setXY(6*y+3,x,0),f.setXY(6*y+4,A,1),f.setXY(6*y+5,A,0),y++,b+=C}}var _=function(e){var i=n.vector3FromPackedArray(T.worldSpacePointPositions,e);T.labelVertexMap[e].forEach(function(e){t.positions.setXYZ(e,i.x,i.y,i.z)})},T=this;for(v=0;v<l;v++)_(v);this.labelsMesh=new o.Mesh(this.geometry,this.material),this.labelsMesh.frustumCulled=!1,this.scene.add(this.labelsMesh)}}},t.prototype.colorLabels=function(t){if(null!=this.labelStrings&&null!=this.geometry&&null!=t){var e=this.geometry.getAttribute("color");e.array=this.renderColors;for(var i=t.length/r.RGBA_NUM_ELEMENTS,n=0,s=0;s<i;++s){for(var a=new o.Color(t[n],t[n+1],t[n+2]),l=this.labelVertexMap[s].length,h=0;h<l;++h)e.setXYZ(this.labelVertexMap[s][h],a.r,a.g,a.b);n+=r.RGBA_NUM_ELEMENTS}e.needsUpdate=!0}},t.prototype.setScene=function(t){this.scene=t},t.prototype.dispose=function(){this.labelsMesh&&(this.scene&&this.scene.remove(this.labelsMesh),this.labelsMesh=null),this.geometry&&(this.geometry.dispose(),this.geometry=null),null!=this.glyphTexture&&null!=this.glyphTexture.texture&&(this.glyphTexture.texture.dispose(),this.glyphTexture.texture=null)},t.prototype.onPickingRender=function(t){if(null!=this.geometry){this.material.uniforms.texture.value=this.glyphTexture.texture,this.material.uniforms.picking.value=!0;var e=this.geometry.getAttribute("color");e.array=this.pickingColors,e.needsUpdate=!0}else this.createLabels()},t.prototype.onRender=function(t){if(null!=this.geometry){this.colorLabels(t.pointColors),this.material.uniforms.texture.value=this.glyphTexture.texture,this.material.uniforms.picking.value=!1;var e=this.geometry.getAttribute("color");e.array=this.renderColors,e.needsUpdate=!0}else this.createLabels()},t.prototype.onPointPositionsChanged=function(t){this.worldSpacePointPositions=t,this.dispose()},t.prototype.setLabelStrings=function(t){this.labelStrings=t,this.dispose()},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizer3DLabels=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),n=i(2),r=i(1),s=i(3),a=function(t){return"\n    // Index of the specific vertex (passed in as bufferAttribute), and the\n    // variable that will be used to pass it to the fragment shader.\n    attribute float spriteIndex;\n    attribute vec4 color;\n    attribute float scaleFactor;\n\n    varying vec2 xyIndex;\n    varying vec4 vColor;\n\n    uniform bool sizeAttenuation;\n    uniform float pointSize;\n    uniform float spritesPerRow;\n    uniform float spritesPerColumn;\n\n    varying float fogDepth;\n\n    void main() {\n      // Pass index and color values to fragment shader.\n      vColor = color;\n      xyIndex = vec2(mod(spriteIndex, spritesPerRow),\n                floor(spriteIndex / spritesPerColumn));\n\n      // Transform current vertex by modelViewMatrix (model world position and\n      // camera world position matrix).\n      vec4 cameraSpacePos = modelViewMatrix * vec4(position, 1.0);\n\n      // Project vertex in camera-space to screen coordinates using the camera's\n      // projection matrix.\n      gl_Position = projectionMatrix * cameraSpacePos;\n\n      // Create size attenuation (if we're in 3D mode) by making the size of\n      // each point inversly proportional to its distance to the camera.\n      float outputPointSize = pointSize;\n      if (sizeAttenuation) {\n        outputPointSize = -pointSize / cameraSpacePos.z;\n        fogDepth = pointSize / outputPointSize * 1.2;\n      } else {  // Create size attenuation (if we're in 2D mode)\n        const float PI = 3.1415926535897932384626433832795;\n        const float minScale = 0.1;  // minimum scaling factor\n        const float outSpeed = 2.0;  // shrink speed when zooming out\n        const float outNorm = (1. - minScale) / atan(outSpeed);\n        const float maxScale = 15.0;  // maximum scaling factor\n        const float inSpeed = 0.02;  // enlarge speed when zooming in\n        const float zoomOffset = 0.3;  // offset zoom pivot\n        float zoom = projectionMatrix[0][0] + zoomOffset;  // zoom pivot\n        float scale = zoom < 1. ? 1. + outNorm * atan(outSpeed * (zoom - 1.)) :\n                      1. + 2. / PI * (maxScale - 1.) * atan(inSpeed * (zoom - 1.));\n        outputPointSize = pointSize * scale;\n      }\n\n      gl_PointSize =\n        max(outputPointSize * scaleFactor, "+t.toFixed(1)+");\n    }"},l="\n    bool point_in_unit_circle(vec2 spriteCoord) {\n      vec2 centerToP = spriteCoord - vec2(0.5, 0.5);\n      return dot(centerToP, centerToP) < (0.5 * 0.5);\n    }\n\n    bool point_in_unit_equilateral_triangle(vec2 spriteCoord) {\n      vec3 v0 = vec3(0, 1, 0);\n      vec3 v1 = vec3(0.5, 0, 0);\n      vec3 v2 = vec3(1, 1, 0);\n      vec3 p = vec3(spriteCoord, 0);\n      float p_in_v0_v1 = cross(v1 - v0, p - v0).z;\n      float p_in_v1_v2 = cross(v2 - v1, p - v1).z;\n      return (p_in_v0_v1 > 0.0) && (p_in_v1_v2 > 0.0);\n    }\n\n    bool point_in_unit_square(vec2 spriteCoord) {\n      return true;\n    }\n  ",h="\n    varying vec2 xyIndex;\n    varying vec4 vColor;\n\n    uniform sampler2D texture;\n    uniform float spritesPerRow;\n    uniform float spritesPerColumn;\n    uniform bool isImage;\n\n    "+o.ShaderChunk.common+"\n    "+l+"\n    uniform vec3 fogColor;\n    varying float fogDepth;\n\t\tuniform float fogNear;\n    uniform float fogFar;\n\n    void main() {\n      if (isImage) {\n        // Coordinates of the vertex within the entire sprite image.\n        vec2 coords =\n          (gl_PointCoord + xyIndex) / vec2(spritesPerRow, spritesPerColumn);\n        gl_FragColor = vColor * texture2D(texture, coords);\n      } else {\n        bool inside = point_in_unit_circle(gl_PointCoord);\n        if (!inside) {\n          discard;\n        }\n        gl_FragColor = vColor;\n      }\n      float fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n      gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n    }",c=function(){function t(t,e){this.styles=t,this.id="SPRITES",this.isSpriteSheetMode=!1,this.spritesPerRow=0,this.spritesPerColumn=0,this.spriteDimensions=[0,0],this.worldSpacePointPositions=new Float32Array,this.pickingColors=new Float32Array,this.renderColors=new Float32Array,this.standinTextureForPoints=r.createTextureFromCanvas(document.createElement("canvas")),e&&(this.spriteSheetParams=e,this.setSpriteSheet(e),this.isSpriteSheetMode=!0),this.renderMaterial=this.createRenderMaterial(),this.pickingMaterial=this.createPickingMaterial()}return t.prototype.createUniforms=function(){return{texture:{type:"t"},spritesPerRow:{type:"f"},spritesPerColumn:{type:"f"},fogColor:{type:"c"},fogNear:{type:"f"},fogFar:{type:"f"},isImage:{type:"bool"},sizeAttenuation:{type:"bool"},pointSize:{type:"f"}}},t.prototype.createRenderMaterial=function(){this.isSpriteSheetMode;var t=this.createUniforms();return new o.ShaderMaterial({uniforms:t,vertexShader:a(this.styles.sprites.minPointSize),fragmentShader:h,transparent:!0,depthFunc:o.LessDepth,fog:this.styles.fog.enabled,blending:o.NormalBlending})},t.prototype.createPickingMaterial=function(){var t=this.createUniforms();return new o.ShaderMaterial({uniforms:t,vertexShader:a(this.styles.sprites.minPointSize),fragmentShader:"\n    varying vec2 xyIndex;\n    varying vec4 vColor;\n    uniform bool isImage;\n\n    \n    bool point_in_unit_circle(vec2 spriteCoord) {\n      vec2 centerToP = spriteCoord - vec2(0.5, 0.5);\n      return dot(centerToP, centerToP) < (0.5 * 0.5);\n    }\n\n    bool point_in_unit_equilateral_triangle(vec2 spriteCoord) {\n      vec3 v0 = vec3(0, 1, 0);\n      vec3 v1 = vec3(0.5, 0, 0);\n      vec3 v2 = vec3(1, 1, 0);\n      vec3 p = vec3(spriteCoord, 0);\n      float p_in_v0_v1 = cross(v1 - v0, p - v0).z;\n      float p_in_v1_v2 = cross(v2 - v1, p - v1).z;\n      return (p_in_v0_v1 > 0.0) && (p_in_v1_v2 > 0.0);\n    }\n\n    bool point_in_unit_square(vec2 spriteCoord) {\n      return true;\n    }\n  \n\n    varying float fogDepth;\n\n    void main() {\n      xyIndex; // Silence 'unused variable' warning.\n      fogDepth; // Silence 'unused variable' warning.\n      if (isImage) {\n        gl_FragColor = vColor;\n      } else {\n        bool inside = point_in_unit_circle(gl_PointCoord);\n        if (!inside) {\n          discard;\n        }\n        gl_FragColor = vColor;\n      }\n    }",transparent:!0,depthTest:!0,depthWrite:!0,fog:!1,blending:o.NormalBlending})},t.prototype.createPointSprites=function(t,e){var i=null!=e?e.length/s.XYZ_NUM_ELEMENTS:0,n=this.createGeometry(i);this.fog=new o.Fog(16777215),this.points=new o.Points(n,this.renderMaterial),this.points.frustumCulled=!1,null!=this.spriteIndexBufferAttribute&&this.points.geometry.addAttribute("spriteIndex",this.spriteIndexBufferAttribute),t.add(this.points)},t.prototype.calculatePointSize=function(t){var e=this.styles.sprites.imageSize;if(this.texture)return t?e:this.spriteDimensions[0];var i=null!=this.worldSpacePointPositions?this.worldSpacePointPositions.length/s.XYZ_NUM_ELEMENTS:1,o=200/Math.log(i)/Math.log(8);return t?o:o/1.5},t.prototype.createGeometry=function(t){var e=t;this.pickingColors=new Float32Array(e*s.RGBA_NUM_ELEMENTS);for(var i=0,n=0;n<e;n++){var r=new o.Color(n);this.pickingColors[i++]=r.r,this.pickingColors[i++]=r.g,this.pickingColors[i++]=r.b,this.pickingColors[i++]=1}var a=new o.BufferGeometry;return a.addAttribute("position",new o.BufferAttribute(new Float32Array([]),s.XYZ_NUM_ELEMENTS)),a.addAttribute("color",new o.BufferAttribute(new Float32Array([]),s.RGBA_NUM_ELEMENTS)),a.addAttribute("scaleFactor",new o.BufferAttribute(new Float32Array([]),s.INDEX_NUM_ELEMENTS)),a.computeVertexNormals(),a},t.prototype.setFogDistances=function(t,e,i){var o=this.styles.fog,n=o.threshold,r=o.enabled;if(t&&r){var a=this.worldSpacePointPositions.length/s.XYZ_NUM_ELEMENTS;this.fog.near=e;var l=2-Math.min(a,n)/n;this.fog.far=i*l}else this.fog.near=1/0,this.fog.far=1/0},t.prototype.dispose=function(){this.disposeGeometry(),this.disposeSpriteSheet()},t.prototype.disposeGeometry=function(){null!=this.points&&(this.scene.remove(this.points),this.points.geometry.dispose(),this.points=null,this.worldSpacePointPositions=null)},t.prototype.disposeSpriteSheet=function(){this.texture&&this.texture.dispose(),this.texture=null,this.renderMaterial=null,this.pickingMaterial=null,this.spriteSheetImage=null},t.prototype.setScene=function(t){this.scene=t},t.prototype.setSpriteSheet=function(t){var e=this,i=t.spriteDimensions,n=t.spriteIndices,a=t.onImageLoad,l=t.spritesheetImage;if("string"==typeof l){var h=l;(l=new Image).src=h}this.spriteSheetImage=l,this.texture=r.createTextureFromImage(this.spriteSheetImage,function(){e.spritesPerRow=e.spriteSheetImage.width/i[0],e.spritesPerColumn=e.spriteSheetImage.height/i[1],a()}),this.spriteDimensions=i,this.spriteIndexBufferAttribute=new o.BufferAttribute(n,s.INDEX_NUM_ELEMENTS),null!=this.points&&this.points.geometry.addAttribute("spriteIndex",this.spriteIndexBufferAttribute)},t.prototype.onPointPositionsChanged=function(t){null!=this.points&&this.worldSpacePointPositions.length!==t.length&&this.disposeGeometry(),this.worldSpacePointPositions=t,null==this.points&&this.createPointSprites(this.scene,t),this.spriteSheetParams&&this.setSpriteSheet(this.spriteSheetParams),this.renderMaterial=this.createRenderMaterial(),this.pickingMaterial=this.createPickingMaterial();var e=this.points.geometry.getAttribute("position");e.array=t,e.count=t.length/s.XYZ_NUM_ELEMENTS,e.needsUpdate=!0},t.prototype.onPickingRender=function(t){var e=t.cameraType===n.CameraType.Perspective;this.pickingMaterial.uniforms.spritesPerRow.value=this.spritesPerRow,this.pickingMaterial.uniforms.spritesPerRow.value=this.spritesPerColumn,this.pickingMaterial.uniforms.sizeAttenuation.value=e,this.pickingMaterial.uniforms.pointSize.value=this.calculatePointSize(e),this.points.material=this.pickingMaterial;var i=this.points.geometry.getAttribute("color");i.array=this.pickingColors,i.count=this.pickingColors.length/s.RGBA_NUM_ELEMENTS,i.needsUpdate=!0;var o=this.points.geometry.getAttribute("scaleFactor");o.array=t.pointScaleFactors,o.count=t.pointScaleFactors.length,o.count=t.pointScaleFactors.length/s.INDEX_NUM_ELEMENTS,o.needsUpdate=!0},t.prototype.onRender=function(t){var e=t.camera instanceof o.PerspectiveCamera;this.setFogDistances(e,t.nearestCameraSpacePointZ,t.farthestCameraSpacePointZ),this.scene.fog=this.fog,this.scene.fog.color=new o.Color(t.backgroundColor),this.renderMaterial.uniforms.fogColor.value=this.scene.fog.color,this.renderMaterial.uniforms.fogNear.value=this.fog.near,this.renderMaterial.uniforms.fogFar.value=this.fog.far,this.renderMaterial.uniforms.spritesPerRow.value=this.spritesPerRow,this.renderMaterial.uniforms.spritesPerColumn.value=this.spritesPerColumn,this.renderMaterial.uniforms.isImage.value=null!=this.texture,this.renderMaterial.uniforms.texture.value=null!=this.texture?this.texture:this.standinTextureForPoints,this.renderMaterial.uniforms.sizeAttenuation.value=e,this.renderMaterial.uniforms.pointSize.value=this.calculatePointSize(e),this.points.material=this.renderMaterial;var i=this.points.geometry.getAttribute("color");this.renderColors=t.pointColors,i.array=this.renderColors,i.count=this.renderColors.length/s.RGBA_NUM_ELEMENTS,i.needsUpdate=!0;var n=this.points.geometry.getAttribute("scaleFactor");n.array=t.pointScaleFactors,n.count=t.pointScaleFactors.length/s.INDEX_NUM_ELEMENTS,n.needsUpdate=!0},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizerSprites=c},function(t,e,i){"use strict";var o=this&&this.__read||function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,n,r=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i(2),s=i(15),a=i(1),l=function(){function t(t,e){this.styles=e,this.id="CANVAS_LABELS",this.worldSpacePointPositions=new Float32Array,this.labelsActive=!0,this.canvas=document.createElement("canvas"),t.appendChild(this.canvas),this.gc=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.left="0",this.canvas.style.top="0",this.canvas.style.pointerEvents="none"}return t.prototype.removeAllLabels=function(){var t=this.canvas.width*window.devicePixelRatio,e=this.canvas.height*window.devicePixelRatio;this.gc.clearRect(0,0,t,e)},t.prototype.makeLabels=function(t){if(null!=t.labels&&0!==t.labels.pointIndices.length&&null!=this.worldSpacePointPositions){var e,i=t.labels,l=t.cameraType===r.CameraType.Perspective,h=parseInt(this.gc.font,10),c=window.devicePixelRatio,u=this.canvas.width*c,p=this.canvas.height*c,d={loX:0,hiX:u,loY:0,hiY:p};e=new s.CollisionGrid(d,u/25,p/50);var f=[t.farthestCameraSpacePointZ,t.nearestCameraSpacePointZ],m=function(t){return a.scaleExponential(t,f,[.1,1])},y=t.camera.position,v=y.clone().sub(t.cameraTarget),g=new n.Vector3;this.gc.textBaseline="middle",this.gc.miterLimit=2;for(var b=Math.min(1e4,i.pointIndices.length),S=0;S<b;++S){var P,C=i.pointIndices[S];if(P=a.vector3FromPackedArray(this.worldSpacePointPositions,C),g.copy(y).sub(P),!(v.dot(g)<0)){var E=o(a.vector3DToScreenCoords(t.camera,t.screenWidth,t.screenHeight,P),2),M=E[0],w=E[1],x={loX:(M+=4)-2,hiX:M+1+2,loY:w-h/2-2,hiY:w+h/2+2};if(e.insert(x,!0)){var A=i.labelStrings[S],_=i.defaultFontSize*i.scaleFactors[S]*c;if(this.gc.font=_+"px roboto",x.hiX+=this.gc.measureText(A).width-1,e.insert(x)){var T=1;l&&1===i.useSceneOpacityFlags[S]&&(T=m(g.length())),this.gc.fillStyle=this.styleStringFromPackedRgba(i.fillColors,S,T),this.gc.strokeStyle=this.styleStringFromPackedRgba(i.strokeColors,S,T),this.gc.lineWidth=this.styles.label.strokeWidth,this.gc.strokeText(A,M,w),this.gc.lineWidth=this.styles.label.fillWidth,this.gc.fillText(A,M,w)}}}}}},t.prototype.styleStringFromPackedRgba=function(t,e,i){var o=3*e;return"rgba("+t[o]+","+t[o+1]+","+t[o+2]+","+i+")"},t.prototype.onResize=function(t,e){var i=window.devicePixelRatio;this.canvas.width=t*i,this.canvas.height=e*i,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"},t.prototype.dispose=function(){this.removeAllLabels()},t.prototype.onPointPositionsChanged=function(t){this.worldSpacePointPositions=t,this.removeAllLabels()},t.prototype.onRender=function(t){this.labelsActive&&(this.removeAllLabels(),this.makeLabels(t))},t.prototype.setScene=function(t){},t.prototype.onPickingRender=function(t){},t}();e.ScatterPlotVisualizerCanvasLabels=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e,i){this.bound=t,this.cellWidth=e,this.cellHeight=i,this.numHorizCells=Math.ceil(this.boundWidth(t)/e),this.numVertCells=Math.ceil(this.boundHeight(t)/i),this.grid=new Array(this.numHorizCells*this.numVertCells)}return t.prototype.boundWidth=function(t){return t.hiX-t.loX},t.prototype.boundHeight=function(t){return t.hiY-t.loY},t.prototype.boundsIntersect=function(t,e){return!(t.loX>e.hiX||t.loY>e.hiY||t.hiX<e.loX||t.hiY<e.loY)},t.prototype.insert=function(t,e){if(void 0===e&&(e=!1),t.hiX<this.bound.loX||t.loX>this.bound.hiX||t.hiY<this.bound.loY||t.loY>this.bound.hiY)return!1;for(var i=this.getCellX(t.loX),o=this.getCellX(t.hiX),n=this.getCellY(t.loY),r=this.getCellY(t.hiY),s=n*this.numHorizCells+i,a=s,l=n;l<=r;l++){for(var h=i;h<=o;h++){var c=this.grid[a++];if(c)for(var u=0;u<c.length;u++)if(this.boundsIntersect(t,c[u]))return!1}a+=this.numHorizCells-(o-i+1)}if(e)return!0;a=s;for(l=n;l<=r;l++){for(h=i;h<=o;h++)this.grid[a]?this.grid[a].push(t):this.grid[a]=[t],a++;a+=this.numHorizCells-(o-i+1)}return!0},t.prototype.getCellX=function(t){return Math.floor((t-this.bound.loX)/this.cellWidth)},t.prototype.getCellY=function(t){return Math.floor((t-this.bound.loY)/this.cellHeight)},t}();e.CollisionGrid=o},function(t,e,i){"use strict";var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i(1),s=i(3),a=function(){function t(){this.id="POLYLINES",this.sequences=[],this.polylines=[],this.polylinePositionBuffer={},this.polylineColorBuffer={},this.pointSequenceIndices=new Map}return t.prototype.getPointSequenceIndex=function(t){return this.pointSequenceIndices.get(t)},t.prototype.updateSequenceIndices=function(){for(var t=0;t<this.sequences.length;t++)for(var e=this.sequences[t],i=0;i<e.indices.length-1;i++){var o=e.indices[i];this.pointSequenceIndices.set(o,t),this.pointSequenceIndices.set(o+1,t)}},t.prototype.createPolylines=function(){this.updateSequenceIndices(),this.polylines=[];for(var t=0;t<this.sequences.length;t++){var e=new n.BufferGeometry;e.addAttribute("position",this.polylinePositionBuffer[t]),e.addAttribute("color",this.polylineColorBuffer[t]);var i=new n.LineBasicMaterial({linewidth:1,opacity:1,transparent:!0,vertexColors:n.VertexColors}),o=new n.LineSegments(e,i);o.frustumCulled=!1,this.polylines.push(o),this.scene.add(o)}},t.prototype.dispose=function(){var t,e;try{for(var i=o(this.polylines),n=i.next();!n.done;n=i.next()){var r=n.value;this.scene.remove(r),r.geometry.dispose()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.polylines=[],this.polylinePositionBuffer={},this.polylineColorBuffer={}},t.prototype.setScene=function(t){this.scene=t},t.prototype.setSequences=function(t){this.sequences=t},t.prototype.onPointPositionsChanged=function(t){if(null==t&&this.dispose(),null!=t&&0!==this.sequences.length){for(var e=0;e<this.sequences.length;e++){var i=2*((l=this.sequences[e]).indices.length-1),o=new Float32Array(i*s.XYZ_NUM_ELEMENTS);this.polylinePositionBuffer[e]=new n.BufferAttribute(o,s.XYZ_NUM_ELEMENTS);var a=new Float32Array(i*s.RGBA_NUM_ELEMENTS);this.polylineColorBuffer[e]=new n.BufferAttribute(a,s.RGBA_NUM_ELEMENTS)}for(e=0;e<this.sequences.length;e++){for(var l=this.sequences[e],h=0,c=0;c<l.indices.length-1;c++){var u=l.indices[c],p=l.indices[c+1],d=r.vector3FromPackedArray(t,u),f=r.vector3FromPackedArray(t,p);this.polylinePositionBuffer[e].setXYZ(h,d.x,d.y,d.z),this.polylinePositionBuffer[e].setXYZ(h+1,f.x,f.y,f.z),h+=2}this.polylinePositionBuffer[e].needsUpdate=!0}this.createPolylines()}},t.prototype.onRender=function(t){for(var e=0;e<this.polylines.length;e++){var i=this.polylines[e].material;i.opacity=t.polylineOpacities[e],i.linewidth=t.polylineWidths[e],this.polylineColorBuffer[e].array=t.polylineColors[e],this.polylineColorBuffer[e].needsUpdate=!0}},t.prototype.onPickingRender=function(t){},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizerPolylines=a}])});