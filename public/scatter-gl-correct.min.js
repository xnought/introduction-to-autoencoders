!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("THREE"));else if("function"==typeof define&&define.amd)define(["THREE"],e);else{var i="object"==typeof exports?e(require("THREE")):e(t.THREE);for(var o in i)("object"==typeof exports?exports:t)[o]=i[o]}}(window,(function(t){return function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=4)}([function(e,i){e.exports=t},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(0);function n(t,e){return void 0===e&&(e=!0),t.needsUpdate=e,t.minFilter=o.LinearFilter,t.generateMipmaps=!1,t.flipY=!1,t}e.vector3DToScreenCoords=function(t,e,i,n){var r=window.devicePixelRatio,s=(new o.Vector3).copy(n).project(t);return[(s.x+1)/2*e*r,-(s.y-1)/2*i*r]},e.vector3FromPackedArray=function(t,e){var i=3*e;return new o.Vector3(t[i],t[i+1],t[i+2])},e.getNearFarPoints=function(t,e,i){for(var n=1/0,r=0,s=(new o.Vector3).copy(i).sub(e),a=(new o.Vector3).copy(s).normalize(),l=t.length/3,c=0,h=new o.Vector3,u=new o.Vector3,p=0;p<l;p++){h.x=t[c],h.y=t[c+1],h.z=t[c+2],c+=3,u.copy(h).sub(e);var d=a.dot(u);d<0||(r=d>r?d:r,n=d<n?d:n)}return[n,r]},e.createTextureFromCanvas=function(t){return n(new o.Texture(t))},e.createTextureFromImage=function(t,e){var i=new o.Texture(t);return t.onload=function(){i.needsUpdate=!0,e()},n(i,!1)},e.hasWebGLSupport=function(){try{var t=document.createElement("canvas");return null!=(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(t){return!1}},e.extent=function(t){for(var e=1/0,i=-1/0,o=0;o<t.length;o++){var n=t[o];n<e&&(e=n),n>i&&(i=n)}return[e,i]},e.scaleLinear=function(t,e,i){var o=e[1]-e[0],n=i[1]-i[0];return(t-e[0])/o*n+i[0]},e.scaleExponential=function(t,e,i){var o=Math.pow(e[1],Math.E)-Math.pow(e[0],Math.E),n=i[1]-i[0];return(Math.pow(t,Math.E)-e[0])/o*n+i[0]},e.packRgbIntoUint8Array=function(t,e,i,o,n){t[3*e]=i,t[3*e+1]=o,t[3*e+2]=n},e.styleRgbFromHexColor=function(t){var e=new o.Color(t);return[255*e.r|0,255*e.g|0,255*e.b|0]};var r=function(t){return 100*t+"%"};e.getDefaultPointInPolylineColor=function(t,e,i,n,s,a){var l="hsl("+(i+(n-i)*t/e)+", "+r(s)+", "+r(a)+")";return new o.Color(l)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t,e,i,o,n,r,s){this.pointIndices=t,this.labelStrings=e,this.scaleFactors=i,this.useSceneOpacityFlags=o,this.defaultFontSize=n,this.fillColors=r,this.strokeColors=s};e.LabelRenderParams=o,function(t){t[t.Perspective=0]="Perspective",t[t.Orthographic=1]="Orthographic"}(e.CameraType||(e.CameraType={}));var n=function(t,e,i,o,n,r,s,a,l,c,h,u,p,d){this.camera=t,this.cameraType=e,this.cameraTarget=i,this.screenWidth=o,this.screenHeight=n,this.nearestCameraSpacePointZ=r,this.farthestCameraSpacePointZ=s,this.backgroundColor=a,this.pointColors=l,this.pointScaleFactors=c,this.labels=h,this.polylineColors=u,this.polylineOpacities=p,this.polylineWidths=d};e.RenderContext=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RGB_NUM_ELEMENTS=3,e.RGBA_NUM_ELEMENTS=4,e.XYZ_NUM_ELEMENTS=3,e.UV_NUM_ELEMENTS=2,e.INDEX_NUM_ELEMENTS=1,e.SCATTER_PLOT_CUBE_LENGTH=2},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(5);e.ScatterGL=o.ScatterGL},function(t,e,i){"use strict";var o=this&&this.__read||function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,n,r=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return s},n=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var s=i(6),a=i(9),l=i(10),c=i(2),h=i(11),u=i(1),p=i(3),d=i(12),f=i(13),m=i(14),y=i(16),g=function(){function t(t,e){var i=this;void 0===e&&(e={}),this.pointColorer=null,this.sequences=[],this.renderMode="POINT",this.rotateOnStart=!0,this.selectEnabled=!0,this.showLabelsOnHover=!0,this.hoverPointIndex=null,this.selectedPointIndices=new Set,this.clickCallback=function(){},this.hoverCallback=function(){},this.selectCallback=function(){},this.cameraMoveCallback=function(){},this.cameraDragCallback=function(){},this.onHover=function(t){i.hoverCallback(t),i.hoverPointIndex=t,i.updateScatterPlotAttributes(),i.renderScatterPlot()},this.onClick=function(t){i.clickCallback(t)},this.select=function(t){i.selectEnabled&&(i.selectedPointIndices=new Set(t),i.updateScatterPlotAttributes(),i.renderScatterPlot())},this.onSelect=function(t){i.selectEnabled&&(i.selectCallback(t),i.select(t))},this.containerElement=t,this.styles=h.makeStyles(e.styles),this.setParameters(e),this.scatterPlot=new s.ScatterPlot(t,{camera:e.camera,onClick:this.onClick,onHover:this.onHover,onSelect:this.onSelect,selectEnabled:this.selectEnabled,styles:this.styles,orbitControlParams:e.orbitControls}),this.scatterPlot.onCameraMove(this.cameraMoveCallback),this.scatterPlot.onCameraDrag(this.cameraDragCallback)}return t.prototype.setParameters=function(t){void 0!==t.onCameraDrag&&(this.cameraDragCallback=t.onCameraDrag),void 0!==t.onClick&&(this.clickCallback=t.onClick),void 0!==t.onHover&&(this.hoverCallback=t.onHover),void 0!==t.onSelect&&(this.selectCallback=t.onSelect),void 0!==t.onCameraMove&&(this.cameraMoveCallback=t.onCameraMove),void 0!==t.pointColorer&&(this.pointColorer=t.pointColorer),void 0!==t.renderMode&&(this.renderMode=t.renderMode),void 0!==t.rotateOnStart&&(this.rotateOnStart=t.rotateOnStart),void 0!==t.selectEnabled&&(this.selectEnabled=t.selectEnabled),void 0!==t.showLabelsOnHover&&(this.showLabelsOnHover=t.showLabelsOnHover)},t.prototype.setCameraPositionAndTarget=function(t,e){this.scatterPlot.setCameraPositionAndTarget(t,e)},t.prototype.render=function(t){this.updateDataset(t),this.setVisualizers(),this.rotateOnStart&&this.scatterPlot.startOrbitAnimation()},t.prototype.renderScatterPlot=function(){this.dataset&&this.scatterPlot.render()},t.prototype.setRenderMode=function(t){this.renderMode=t,this.setVisualizers(),this.updateScatterPlotAttributes(),this.updateScatterPlotPositions()},t.prototype.setTextRenderMode=function(){this.setRenderMode("TEXT"),this.renderScatterPlot()},t.prototype.setPointRenderMode=function(){this.setRenderMode("POINT"),this.renderScatterPlot()},t.prototype.setSpriteRenderMode=function(){this.dataset&&this.dataset.spriteMetadata&&(this.setRenderMode("SPRITE"),this.renderScatterPlot())},t.prototype.setSequences=function(t){this.sequences=t,this.updatePolylineAttributes(),this.setVisualizers(),this.renderScatterPlot()},t.prototype.setPanMode=function(){this.scatterPlot.setInteractionMode("PAN")},t.prototype.setSelectMode=function(){this.scatterPlot.setInteractionMode("SELECT")},t.prototype.setDimensions=function(t){var e=t<2||t>3,i=this.dataset&&t>this.dataset.dimensions;if(e||i)throw new RangeError("Setting invalid dimensionality");this.scatterPlot.setDimensions(t),this.renderScatterPlot()},t.prototype.setPointColorer=function(t){this.pointColorer=t,this.updateScatterPlotAttributes(),this.renderScatterPlot()},t.prototype.callPointColorer=function(t,e){return t(e,this.selectedPointIndices,this.hoverPointIndex)},t.prototype.setHoverPointIndex=function(t){this.hoverPointIndex=t,this.updateScatterPlotAttributes(),this.scatterPlot.orbitIsAnimating()||this.renderScatterPlot()},t.prototype.resize=function(){this.scatterPlot.resize()},t.prototype.updateDataset=function(t){this.setDataset(t),this.scatterPlot.setDimensions(t.dimensions),this.updateScatterPlotAttributes(),this.updateScatterPlotPositions(),this.renderScatterPlot()},t.prototype.isOrbiting=function(){return this.scatterPlot.orbitIsAnimating()},t.prototype.startOrbitAnimation=function(){this.scatterPlot.startOrbitAnimation()},t.prototype.stopOrbitAnimation=function(){this.scatterPlot.stopOrbitAnimation()},t.prototype.setDataset=function(t){this.dataset=t,this.labels3DVisualizer&&this.labels3DVisualizer.setLabelStrings(this.generate3DLabelsArray())},t.prototype.updateScatterPlotPositions=function(){var t=this.dataset;if(t){var e=this.generatePointPositionArray(t);this.scatterPlot.setPointPositions(e)}},t.prototype.updateScatterPlotAttributes=function(){var t=this.dataset;if(t){var e=this.generatePointColorArray(t),i=this.generatePointScaleFactorArray(t),o=this.generateVisibleLabelRenderParams();this.scatterPlot.setPointColors(e),this.scatterPlot.setPointScaleFactors(i),this.scatterPlot.setLabels(o)}},t.prototype.updatePolylineAttributes=function(){var t=this.dataset;if(t){var e=this.generateLineSegmentColorMap(t),i=this.generateLineSegmentOpacityArray(t),o=this.generateLineSegmentWidthArray(t);this.scatterPlot.setPolylineColors(e),this.scatterPlot.setPolylineOpacities(i),this.scatterPlot.setPolylineWidths(o)}},t.prototype.generatePointPositionArray=function(t){var e,i,o=[0,0];e=u.extent(t.points.map((function(t){return t[0]}))),i=u.extent(t.points.map((function(t){return t[1]}))),3===t.dimensions&&(o=u.extent(t.points.map((function(t){return t[2]}))));var n=function(t){return Math.abs(t[1]-t[0])},r=n(e),s=n(i),a=n(o),l=Math.max(r,s,a),c=p.SCATTER_PLOT_CUBE_LENGTH/2,h=function(t,e){return[t/l*-e,e*(t/l)]},d=h(r,c),f=h(s,c),m=h(a,c),y=new Float32Array(3*t.points.length),g=0;return t.points.forEach((function(n,r){var s=t.points[r];y[g++]=u.scaleLinear(s[0],e,d),y[g++]=u.scaleLinear(s[1],i,f),3===t.dimensions?y[g++]=u.scaleLinear(s[2],o,m):y[g++]=0})),y},t.prototype.generateVisibleLabelRenderParams=function(){var t=this.hoverPointIndex,e=this.selectedPointIndices,i=this.styles,o=null!==t?1:0,r=new Uint32Array(o),s=new Float32Array(o),a=new Int8Array(o),l=new Uint8Array(3*o),h=new Uint8Array(3*o),p=[];s.fill(i.label.scaleDefault),a.fill(1);var d=0;if(null!==t){p.push(this.getLabelText(t)),r[d]=t,s[d]=i.label.scaleLarge,a[d]=0;var f=u.styleRgbFromHexColor(i.label.fillColorHover);u.packRgbIntoUint8Array(l,d,f[0],f[1],f[2]);var m=u.styleRgbFromHexColor(i.label.strokeColorHover);u.packRgbIntoUint8Array(h,d,m[0],m[1],m[1]),++d}f=u.styleRgbFromHexColor(i.label.fillColorSelected),m=u.styleRgbFromHexColor(i.label.strokeColorSelected);if(1===e.size){var y=n(e)[0];p.push(this.getLabelText(y)),r[d]=y,s[d]=i.label.scaleLarge,a[d]=0,u.packRgbIntoUint8Array(l,d,f[0],f[1],f[2]),u.packRgbIntoUint8Array(h,d,m[0],m[1],m[2])}return new c.LabelRenderParams(new Float32Array(r),p,s,a,i.label.fontSize,l,h)},t.prototype.generatePointScaleFactorArray=function(t){var e,i,o=this.hoverPointIndex,n=this.selectedPointIndices,s=this.styles.point,a=s.scaleDefault,l=s.scaleSelected,c=s.scaleHover,h=new Float32Array(t.points.length);h.fill(a);n.size;try{for(var u=r(n.values()),p=u.next();!p.done;p=u.next()){h[p.value]=l}}catch(t){e={error:t}}finally{try{p&&!p.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}return null!=o&&(h[o]=c),h},t.prototype.generatePointColorArray=function(t){var e,i,o=this.hoverPointIndex,n=this.pointColorer,s=this.selectedPointIndices,l=this.styles.point,c=l.colorHover,h=l.colorNoSelection,u=l.colorSelected,d=l.colorUnselected,f=new Float32Array(t.points.length*p.RGBA_NUM_ELEMENTS),m=d,y=h;"TEXT"===this.renderMode&&(m=this.styles.label3D.colorUnselected,y=this.styles.label3D.colorNoSelection),"SPRITE"===this.renderMode&&(m=this.styles.sprites.colorUnselected,y=this.styles.sprites.colorNoSelection);var g=t.points.length,v=this.selectedPointIndices.size;if(n)for(var b=0,P=0;P<g;++P){var C=a.parseColor(this.callPointColorer(n,P)||y);f[b++]=C.r,f[b++]=C.g,f[b++]=C.b,f[b++]=C.opacity}else{for(b=0,C=v>0?a.parseColor(m):a.parseColor(y),P=0;P<g;++P)f[b++]=C.r,f[b++]=C.g,f[b++]=C.b,f[b++]=C.opacity;C=a.parseColor(u);try{for(var S=r(s.values()),E=S.next();!E.done;E=S.next()){var w=E.value*p.RGBA_NUM_ELEMENTS;f[w++]=C.r,f[w++]=C.g,f[w++]=C.b,f[w++]=C.opacity}}catch(t){e={error:t}}finally{try{E&&!E.done&&(i=S.return)&&i.call(S)}finally{if(e)throw e.error}}if(null!=o){var M=a.parseColor(c),x=o*p.RGBA_NUM_ELEMENTS;f[x++]=M.r,f[x++]=M.g,f[x++]=M.b,f[x++]=M.opacity}}return f},t.prototype.generate3DLabelsArray=function(){var t=this.dataset;if(!t)return[];for(var e=[],i=t.points.length,o=0;o<i;++o)e.push(this.getLabelText(o));return e},t.prototype.generateLineSegmentColorMap=function(t){for(var e=this.pointColorer,i=this.styles,o={},n=0;n<this.sequences.length;n++){var r=this.sequences[n],s=new Float32Array(2*(r.indices.length-1)*3),l=0;if(e)for(var c=0;c<r.indices.length-1;c++){var h=a.parseColor(this.callPointColorer(e,r.indices[c])),p=a.parseColor(this.callPointColorer(e,r.indices[c+1]));s[l++]=h.r,s[l++]=h.g,s[l++]=h.b,s[l++]=p.r,s[l++]=p.g,s[l++]=p.b}else for(c=0;c<r.indices.length-1;c++){h=u.getDefaultPointInPolylineColor(c,r.indices.length,i.polyline.startHue,i.polyline.endHue,i.polyline.saturation,i.polyline.lightness),p=u.getDefaultPointInPolylineColor(c+1,r.indices.length,i.polyline.startHue,i.polyline.endHue,i.polyline.saturation,i.polyline.lightness);s[l++]=h.r,s[l++]=h.g,s[l++]=h.b,s[l++]=p.r,s[l++]=p.g,s[l++]=p.b}o[n]=s}return o},t.prototype.generateLineSegmentOpacityArray=function(t){var e=this.selectedPointIndices,i=this.styles,o=new Float32Array(this.sequences.length);if(e.size>0){o.fill(i.polyline.deselectedOpacity);var r=this.polylineVisualizer.getPointSequenceIndex(n(e)[0]);void 0!==r&&(o[r]=i.polyline.selectedOpacity)}else o.fill(i.polyline.defaultOpacity);return o},t.prototype.generateLineSegmentWidthArray=function(t){var e=this.selectedPointIndices,i=this.styles,o=new Float32Array(this.sequences.length);if(o.fill(i.polyline.defaultLineWidth),e.size>0){var r=this.polylineVisualizer.getPointSequenceIndex(n(e)[0]);void 0!==r&&(o[r]=i.polyline.selectedLineWidth)}return o},t.prototype.getLabelText=function(t){var e=this.dataset;if(!e)return"";var i=e.metadata[t];return i&&null!=i.label?""+i.label:""},t.prototype.initializeCanvasLabelsVisualizer=function(){return this.canvasLabelsVisualizer||(this.canvasLabelsVisualizer=new m.ScatterPlotVisualizerCanvasLabels(this.containerElement,this.styles)),this.canvasLabelsVisualizer},t.prototype.initialize3DLabelsVisualizer=function(){return this.labels3DVisualizer||(this.labels3DVisualizer=new d.ScatterPlotVisualizer3DLabels(this.styles)),this.labels3DVisualizer.setLabelStrings(this.generate3DLabelsArray()),this.labels3DVisualizer},t.prototype.initializePointVisualizer=function(){return this.pointVisualizer||(this.pointVisualizer=new f.ScatterPlotVisualizerSprites(this.styles)),this.pointVisualizer},t.prototype.initializeSpritesheetVisualizer=function(){var t=this,e=this.styles,i=this.dataset,o=i.spriteMetadata;if(!this.spritesheetVisualizer&&o){if(!o.spriteImage||!o.singleSpriteSize)return;var n=i.points.length,r=void 0;if(o.spriteIndices)r=new Float32Array(o.spriteIndices);else{r=new Float32Array(n);for(var s=0;s<n;++s)r[s]=s}var a=new f.ScatterPlotVisualizerSprites(e,{spritesheetImage:o.spriteImage,spriteDimensions:o.singleSpriteSize,spriteIndices:r,onImageLoad:function(){return t.renderScatterPlot()}});a.id="SPRITE_SHEET_VISUALIZER",this.spritesheetVisualizer=a}return this.spritesheetVisualizer},t.prototype.initializePolylineVisualizer=function(){return this.polylineVisualizer||(this.polylineVisualizer=new y.ScatterPlotVisualizerPolylines),this.polylineVisualizer.setSequences(this.sequences),this.polylineVisualizer},t.prototype.setVisualizers=function(){var t=this.dataset,e=this.renderMode,i=[];if("TEXT"===e){var o=this.initialize3DLabelsVisualizer();i.push(o)}else if("POINT"===e){o=this.initializePointVisualizer();i.push(o)}else if("SPRITE"===e&&t.spriteMetadata){(o=this.initializeSpritesheetVisualizer())&&i.push(o)}if(this.sequences.length>0){o=this.initializePolylineVisualizer();i.push(o)}if(("POINT"===e||"SPRITE"===e)&&this.showLabelsOnHover){o=this.initializeCanvasLabelsVisualizer();i.push(o)}this.scatterPlot.setActiveVisualizers(i)},t.Dataset=l.Dataset,t}();e.ScatterGL=g},function(t,e,i){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},n=this&&this.__read||function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,n,r=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return s},r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var s=i(0),a=i(7),l=i(2),c=i(1),h=i(8),u=new s.Vector3(.45,.9,1.6),p=new s.Vector3(0,0,0),d=new s.Vector3(0,0,4),f=new s.Vector3(0,0,0),m={mouseRotateSpeed:1,autoRotateSpeed:2,zoomSpeed:.125},y=function(){function t(t,e){var i=this;this.clickCallback=function(){},this.hoverCallback=function(){},this.selectCallback=function(){},this.selectEnabled=!0,this.visualizers=new Map,this.onCameraMoveListeners=[],this.onCameraDragListeners=[],this.height=0,this.width=0,this.dimensions=3,this.interactionMode="PAN",this.pickingTexture=new s.WebGLRenderTarget(0,0),this.orbitAnimationOnNextCameraCreation=!1,this.orbitAnimationId=null,this.worldSpacePointPositions=new Float32Array(0),this.pointColors=new Float32Array(0),this.pointScaleFactors=new Float32Array(0),this.polylineColors={},this.polylineOpacities=new Float32Array(0),this.polylineWidths=new Float32Array(0),this.selecting=!1,this.nearestPoint=null,this.mouseIsDown=!1,this.isDragSequence=!1,this.lastHovered=null,this.container=t,this.styles=e.styles,this.setParameters(e),this.computeLayoutValues(),this.scene=new s.Scene,this.renderer=new s.WebGLRenderer({alpha:!0,premultipliedAlpha:!1,antialias:!1}),this.renderer.setClearColor(this.styles.backgroundColor,1),this.container.appendChild(this.renderer.domElement),this.light=new s.PointLight(16772287,1,0),this.scene.add(this.light),this.orbitControlParams=o(o({},m),e.orbitControlParams),this.rectangleSelector=new h.ScatterPlotRectangleSelector(this.container,(function(t){i.selectBoundingBox(t)}),this.styles),this.addInteractionListeners(),this.setDimensions(3),this.makeCamera(e.camera),this.resize()}return t.prototype.setParameters=function(t){void 0!==t.onClick&&(this.clickCallback=t.onClick),void 0!==t.onHover&&(this.hoverCallback=t.onHover),void 0!==t.onSelect&&(this.selectCallback=t.onSelect),void 0!==t.selectEnabled&&(this.selectEnabled=t.selectEnabled)},t.prototype.addInteractionListeners=function(){this.container.addEventListener("mousemove",this.onMouseMove.bind(this)),this.container.addEventListener("mousedown",this.onMouseDown.bind(this)),this.container.addEventListener("mouseup",this.onMouseUp.bind(this)),this.container.addEventListener("click",this.onClick.bind(this)),window.addEventListener("keydown",this.onKeyDown.bind(this),!1),window.addEventListener("keyup",this.onKeyUp.bind(this),!1)},t.prototype.addCameraControlsEventListeners=function(t){var e=this;t.addEventListener("start",(function(){e.stopOrbitAnimation(),e.onCameraMoveListeners.forEach((function(i){return i(e.camera.position,t.target)}))})),t.addEventListener("change",(function(){e.onCameraDragListeners.forEach((function(i){return i(e.camera.position,t.target)})),e.render()})),t.addEventListener("end",(function(){}))},t.prototype.makeOrbitControls=function(t,e){null!=this.orbitCameraControls&&this.orbitCameraControls.dispose();var i=new a.OrbitControls(t,this.renderer.domElement);i.zoomSpeed=this.orbitControlParams.zoomSpeed,i.enableRotate=e,i.autoRotate=!1,i.enableKeys=!1,i.rotateSpeed=this.orbitControlParams.mouseRotateSpeed,e?(i.mouseButtons.LEFT=s.MOUSE.LEFT,i.mouseButtons.RIGHT=s.MOUSE.RIGHT):(i.mouseButtons.LEFT=s.MOUSE.RIGHT,i.mouseButtons.RIGHT=s.MOUSE.LEFT),i.reset(),this.camera=t,this.orbitCameraControls=i,this.addCameraControlsEventListeners(this.orbitCameraControls)},t.prototype.makeCamera=function(t){void 0===t&&(t={});var e=this.makeDefaultCameraDef(this.dimensions,t);this.recreateCamera(e),3===this.dimensions&&this.styles.axesVisible?this.add3dAxes():this.remove3dAxesFromScene()},t.prototype.makeCamera3D=function(t,e,i){var o,n=e/i;(o=new s.PerspectiveCamera(70,n,.01,100)).position.set(t.position[0],t.position[1],t.position[2]);var r=new s.Vector3(t.target[0],t.target[1],t.target[2]);o.lookAt(r),o.zoom=t.zoom,o.updateProjectionMatrix(),this.camera=o,this.makeOrbitControls(o,!0)},t.prototype.makeCamera2D=function(t,e,i){var o,n=new s.Vector3(t.target[0],t.target[1],t.target[2]),r=e/i,a=-1.2,l=1.2,c=-1.2,h=1.2;r>1?(a*=r,l*=r):(h/=r,c/=r),(o=new s.OrthographicCamera(a,l,h,c,-1e3,1e3)).position.set(t.position[0],t.position[1],t.position[2]),o.up=new s.Vector3(0,0,1),o.lookAt(n),o.zoom=t.zoom,o.updateProjectionMatrix(),this.camera=o,this.makeOrbitControls(o,!1)},t.prototype.makeDefaultCameraDef=function(t,e){void 0===e&&(e={});var i=2===t,o=i?d:u,n=i?f:p,r={orthographic:i,zoom:1,position:[o.x,o.y,o.z],target:[n.x,n.y,n.z]};return e.zoom&&(r.zoom=e.zoom),e.position&&(r.position=e.position),e.target&&(r.target=e.target),r},t.prototype.recreateCamera=function(t){t.orthographic?this.makeCamera2D(t,this.width,this.height):this.makeCamera3D(t,this.width,this.height),this.orbitCameraControls.minDistance=.05,this.orbitCameraControls.maxDistance=10,this.orbitCameraControls.update(),this.orbitAnimationOnNextCameraCreation&&this.startOrbitAnimation()},t.prototype.setInteractionMode=function(t){this.interactionMode=t,"SELECT"===t?(this.selecting=!0,this.container.style.cursor="crosshair",this.orbitCameraControls.enabled=!1):(this.selecting=!1,this.container.style.cursor="default",this.orbitCameraControls.enabled=!0)},t.prototype.onClick=function(t,e){if(void 0===e&&(e=!0),!t||!this.selecting){if(!this.isDragSequence&&e){if(this.selectEnabled){var i=null!=this.nearestPoint?[this.nearestPoint]:[];this.selectCallback(i)}this.clickCallback(this.nearestPoint)}this.isDragSequence=!1,this.render()}},t.prototype.onMouseDown=function(t){this.isDragSequence=!1,this.mouseIsDown=!0,this.selecting?(this.rectangleSelector.onMouseDown(t.offsetX,t.offsetY),this.setNearestPointToMouse(t)):!t.ctrlKey&&this.sceneIs3D()&&this.orbitCameraControls.mouseButtons.ORBIT===s.MOUSE.RIGHT?(this.orbitCameraControls.mouseButtons.ORBIT=s.MOUSE.LEFT,this.orbitCameraControls.mouseButtons.PAN=s.MOUSE.RIGHT):t.ctrlKey&&this.sceneIs3D()&&this.orbitCameraControls.mouseButtons.ORBIT===s.MOUSE.LEFT&&(this.orbitCameraControls.mouseButtons.ORBIT=s.MOUSE.RIGHT,this.orbitCameraControls.mouseButtons.PAN=s.MOUSE.LEFT)},t.prototype.onMouseUp=function(t){this.selecting&&(this.rectangleSelector.onMouseUp(),this.render()),this.mouseIsDown=!1},t.prototype.onMouseMove=function(t){this.isDragSequence=this.mouseIsDown,this.selecting&&this.mouseIsDown?(this.rectangleSelector.onMouseMove(t.offsetX,t.offsetY),this.render()):this.mouseIsDown||(this.setNearestPointToMouse(t),this.nearestPoint!=this.lastHovered&&(this.lastHovered=this.nearestPoint,this.hoverCallback(this.nearestPoint)))},t.prototype.onKeyDown=function(t){"Control"===t.key&&this.sceneIs3D()&&(this.orbitCameraControls.mouseButtons.ORBIT=s.MOUSE.RIGHT,this.orbitCameraControls.mouseButtons.PAN=s.MOUSE.LEFT),"Shift"===t.key&&this.selectEnabled&&(this.selecting=!0,this.orbitCameraControls.enabled=!1,this.container.style.cursor="crosshair")},t.prototype.onKeyUp=function(t){"Control"===t.key&&this.sceneIs3D()&&(this.orbitCameraControls.mouseButtons.ORBIT=s.MOUSE.LEFT,this.orbitCameraControls.mouseButtons.PAN=s.MOUSE.RIGHT),"Shift"===t.key&&this.selectEnabled&&(this.selecting=!1,this.orbitCameraControls.enabled=!0,this.container.style.cursor="default",this.render())},t.prototype.getPointIndicesFromBoundingBox=function(t){if(null==this.worldSpacePointPositions)return[];this.camera.updateMatrixWorld();var e=window.devicePixelRatio||1,i=Math.floor(t.x*e),o=Math.floor(t.y*e),r=Math.max(Math.floor(t.width*e),1),a=Math.max(Math.floor(t.height*e),1);if(r<=2&&a<=2)return this.getPointIndicesFromBoundingBoxPickingTexture(t);for(var l=this.renderer.domElement,c=l.width,h=l.height,u=[],p=new s.Vector3,d=0;d<this.worldSpacePointPositions.length;d++){var f=3*d,m=n(this.worldSpacePointPositions.slice(f,f+3),3),y=m[0],g=m[1],v=m[2];p.x=y,p.y=g,p.z=v;var b=p.project(this.camera),P=(b.x+1)*c/2,C=-(b.y-1)*h/2;P>=i&&P<=i+r&&C<=o&&C>=o-a&&u.push(d)}return u},t.prototype.getPointIndicesFromBoundingBoxPickingTexture=function(t){if(null==this.worldSpacePointPositions)return[];var e=this.worldSpacePointPositions.length/3,i=window.devicePixelRatio||1,o=Math.floor(t.x*i),n=Math.floor(t.y*i),r=Math.max(Math.floor(t.width*i),1),s=Math.max(Math.floor(t.height*i),1),a=new Uint8Array(r*s*4);this.renderer.readRenderTargetPixels(this.pickingTexture,o,this.pickingTexture.height-n,r,s,a);for(var l=new Uint8Array(this.worldSpacePointPositions.length),c=0;c<r*s;c++){var h=a[4*c]<<16|a[4*c+1]<<8|a[4*c+2];16777215!==h&&h<e&&(l[h]=1)}var u=[];for(c=0;c<l.length;c++)1===l[c]&&u.push(c);return u},t.prototype.selectBoundingBox=function(t){var e=this.getPointIndicesFromBoundingBox(t);this.selectCallback(e)},t.prototype.setNearestPointToMouse=function(t){if(null!=this.pickingTexture){var e={x:t.offsetX,y:t.offsetY,width:1,height:1},i=this.getPointIndicesFromBoundingBoxPickingTexture(e);this.nearestPoint=i.length?i[0]:null}else this.nearestPoint=null},t.prototype.computeLayoutValues=function(){return this.width=this.container.offsetWidth,this.height=Math.max(1,this.container.offsetHeight),[this.width,this.height]},t.prototype.sceneIs3D=function(){return 3===this.dimensions},t.prototype.remove3dAxesFromScene=function(){var t=this.scene.getObjectByName("axes");return null!=t&&this.scene.remove(t),t},t.prototype.add3dAxes=function(){var t=new s.AxesHelper;t.name="axes",this.scene.add(t)},t.prototype.setDimensions=function(t){if(2!==t&&3!==t)throw new RangeError("dimensions must be 2 or 3");this.dimensions!==t&&(this.dimensions=t,this.makeCamera())},t.prototype.getCameraPosition=function(){var t=this.camera.position;return[t.x,t.y,t.z]},t.prototype.getCameraTarget=function(){var t=this.orbitCameraControls.target;return[t.x,t.y,t.z]},t.prototype.setCameraPositionAndTarget=function(t,e){this.stopOrbitAnimation(),this.camera.position.set(t[0],t[1],t[2]),this.orbitCameraControls.target.set(e[0],e[1],e[2]),this.orbitCameraControls.update(),this.render()},t.prototype.startOrbitAnimation=function(){this.sceneIs3D()&&(null!=this.orbitAnimationId&&this.stopOrbitAnimation(),this.orbitCameraControls.autoRotate=!0,this.orbitCameraControls.autoRotateSpeed=this.orbitControlParams.autoRotateSpeed,this.updateOrbitAnimation())},t.prototype.orbitIsAnimating=function(){return null!=this.orbitAnimationId},t.prototype.updateOrbitAnimation=function(){var t=this;this.orbitCameraControls.update(),this.orbitAnimationId=requestAnimationFrame((function(){return t.updateOrbitAnimation()}))},t.prototype.stopOrbitAnimation=function(){this.orbitCameraControls.autoRotate=!1,this.orbitCameraControls.rotateSpeed=this.orbitControlParams.mouseRotateSpeed,null!=this.orbitAnimationId&&(cancelAnimationFrame(this.orbitAnimationId),this.orbitAnimationId=null)},t.prototype.setActiveVisualizers=function(t){var e,i,o,n,s=new Set(t.map((function(t){return t.id})));try{for(var a=r(this.visualizers.values()),l=a.next();!l.done;l=a.next()){var c=l.value;s.has(c.id)||(c.dispose(),this.visualizers.delete(c.id))}}catch(t){e={error:t}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}try{for(var h=r(t),u=h.next();!u.done;u=h.next()){c=u.value;this.visualizers.set(c.id,c),c.setScene(this.scene),c.onResize(this.width,this.height),this.worldSpacePointPositions&&c.onPointPositionsChanged(this.worldSpacePointPositions)}}catch(t){o={error:t}}finally{try{u&&!u.done&&(n=h.return)&&n.call(h)}finally{if(o)throw o.error}}},t.prototype.disposeAllVisualizers=function(){this.visualizers.forEach((function(t){return t.dispose()})),this.visualizers.clear()},t.prototype.setPointPositions=function(t){this.worldSpacePointPositions=t,this.visualizers.forEach((function(e){return e.onPointPositionsChanged(t)}))},t.prototype.render=function(){var t=this.camera.position.clone();t.x+=1,t.y+=1,this.light.position.set(t.x,t.y,t.z);var e=this.camera instanceof s.PerspectiveCamera?l.CameraType.Perspective:l.CameraType.Orthographic,i=[0,0];null!=this.worldSpacePointPositions&&(i=c.getNearFarPoints(this.worldSpacePointPositions,this.camera.position,this.orbitCameraControls.target));var o=new l.RenderContext(this.camera,e,this.orbitCameraControls.target,this.width,this.height,i[0],i[1],this.styles.backgroundColor,this.pointColors,this.pointScaleFactors,this.labels,this.polylineColors,this.polylineOpacities,this.polylineWidths);this.visualizers.forEach((function(t){return t.onPickingRender(o)}));var n=this.remove3dAxesFromScene();this.renderer.setRenderTarget(this.pickingTexture),this.renderer.render(this.scene,this.camera),null!=n&&this.scene.add(n),this.visualizers.forEach((function(t){return t.onRender(o)})),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera)},t.prototype.setPointColors=function(t){this.pointColors=t},t.prototype.setPointScaleFactors=function(t){this.pointScaleFactors=t},t.prototype.setLabels=function(t){this.labels=t},t.prototype.setPolylineColors=function(t){this.polylineColors=t},t.prototype.setPolylineOpacities=function(t){this.polylineOpacities=t},t.prototype.setPolylineWidths=function(t){this.polylineWidths=t},t.prototype.resetZoom=function(){this.recreateCamera(this.makeDefaultCameraDef(this.dimensions)),this.render()},t.prototype.setDayNightMode=function(t){for(var e=this.container.querySelectorAll("canvas"),i=t?"invert(100%)":"",o=0;o<e.length;o++)e[o].style.filter=i},t.prototype.resize=function(t){void 0===t&&(t=!0);var e=n([this.width,this.height],2),i=e[0],o=e[1],r=n(this.computeLayoutValues(),2),a=r[0],l=r[1];if(3===this.dimensions){(c=this.camera).aspect=a/l,c.updateProjectionMatrix()}else{var c=this.camera,h=a/i,u=l/o,p=(c.right-c.left)*h/2,d=(c.top-c.bottom)*u/2;c.top=d,c.bottom=-d,c.left=-p,c.right=p,c.updateProjectionMatrix()}var f=window.devicePixelRatio||1;this.renderer.setPixelRatio(f),this.renderer.setSize(a,l);var m=new s.Vector2;this.renderer.getSize(m);var y=this.renderer.getPixelRatio();this.pickingTexture=new s.WebGLRenderTarget(m.width*y,m.height*y),this.pickingTexture.texture.minFilter=s.LinearFilter,this.visualizers.forEach((function(t){return t.onResize(a,l)})),t&&this.render()},t.prototype.onCameraMove=function(t){this.onCameraMoveListeners.push(t)},t.prototype.onCameraDrag=function(t){this.onCameraDragListeners.push(t)},t.prototype.clickOnPoint=function(t){this.nearestPoint=t,this.onClick(null,!1)},t}();e.ScatterPlot=y},function(t,e,i){"use strict";i.r(e),i.d(e,"OrbitControls",(function(){return a})),i.d(e,"MapControls",(function(){return l}));var o=i(0);const n={type:"change"},r={type:"start"},s={type:"end"};class a extends o.EventDispatcher{constructor(t,e){super(),void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new o.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:o.MOUSE.ROTATE,MIDDLE:o.MOUSE.DOLLY,RIGHT:o.MOUSE.PAN},this.touches={ONE:o.TOUCH.ROTATE,TWO:o.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return h.phi},this.getAzimuthalAngle=function(){return h.theta},this.listenToKeyEvents=function(t){t.addEventListener("keydown",q),this._domElementKeyEvents=t},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(n),i.update(),l=a.NONE},this.update=function(){const e=new o.Vector3,r=(new o.Quaternion).setFromUnitVectors(t.up,new o.Vector3(0,1,0)),s=r.clone().invert(),m=new o.Vector3,y=new o.Quaternion,g=2*Math.PI;return function(){const t=i.object.position;e.copy(t).sub(i.target),e.applyQuaternion(r),h.setFromVector3(e),i.autoRotate&&l===a.NONE&&T(2*Math.PI/60/60*i.autoRotateSpeed),i.enableDamping?(h.theta+=u.theta*i.dampingFactor,h.phi+=u.phi*i.dampingFactor):(h.theta+=u.theta,h.phi+=u.phi);let o=i.minAzimuthAngle,v=i.maxAzimuthAngle;return isFinite(o)&&isFinite(v)&&(o<-Math.PI?o+=g:o>Math.PI&&(o-=g),v<-Math.PI?v+=g:v>Math.PI&&(v-=g),h.theta=o<=v?Math.max(o,Math.min(v,h.theta)):h.theta>(o+v)/2?Math.max(o,h.theta):Math.min(v,h.theta)),h.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=p,h.radius=Math.max(i.minDistance,Math.min(i.maxDistance,h.radius)),!0===i.enableDamping?i.target.addScaledVector(d,i.dampingFactor):i.target.add(d),e.setFromSpherical(h),e.applyQuaternion(s),t.copy(i.target).add(e),i.object.lookAt(i.target),!0===i.enableDamping?(u.theta*=1-i.dampingFactor,u.phi*=1-i.dampingFactor,d.multiplyScalar(1-i.dampingFactor)):(u.set(0,0,0),d.set(0,0,0)),p=1,!!(f||m.distanceToSquared(i.object.position)>c||8*(1-y.dot(i.object.quaternion))>c)&&(i.dispatchEvent(n),m.copy(i.object.position),y.copy(i.object.quaternion),f=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",Z),i.domElement.removeEventListener("pointerdown",H),i.domElement.removeEventListener("pointercancel",X),i.domElement.removeEventListener("wheel",G),i.domElement.ownerDocument.removeEventListener("pointermove",j),i.domElement.ownerDocument.removeEventListener("pointerup",Y),null!==i._domElementKeyEvents&&i._domElementKeyEvents.removeEventListener("keydown",q)};const i=this,a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,h=new o.Spherical,u=new o.Spherical;let p=1;const d=new o.Vector3;let f=!1;const m=new o.Vector2,y=new o.Vector2,g=new o.Vector2,v=new o.Vector2,b=new o.Vector2,P=new o.Vector2,C=new o.Vector2,S=new o.Vector2,E=new o.Vector2,w=[],M={};function x(){return Math.pow(.95,i.zoomSpeed)}function T(t){u.theta-=t}function A(t){u.phi-=t}const _=function(){const t=new o.Vector3;return function(e,i){t.setFromMatrixColumn(i,0),t.multiplyScalar(-e),d.add(t)}}(),L=function(){const t=new o.Vector3;return function(e,o){!0===i.screenSpacePanning?t.setFromMatrixColumn(o,1):(t.setFromMatrixColumn(o,0),t.crossVectors(i.object.up,t)),t.multiplyScalar(e),d.add(t)}}(),O=function(){const t=new o.Vector3;return function(e,o){const n=i.domElement;if(i.object.isPerspectiveCamera){const r=i.object.position;t.copy(r).sub(i.target);let s=t.length();s*=Math.tan(i.object.fov/2*Math.PI/180),_(2*e*s/n.clientHeight,i.object.matrix),L(2*o*s/n.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(_(e*(i.object.right-i.object.left)/i.object.zoom/n.clientWidth,i.object.matrix),L(o*(i.object.top-i.object.bottom)/i.object.zoom/n.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function k(t){i.object.isPerspectiveCamera?p/=t:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*t)),i.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function z(t){i.object.isPerspectiveCamera?p*=t:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/t)),i.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function R(t){m.set(t.clientX,t.clientY)}function N(t){v.set(t.clientX,t.clientY)}function I(){if(1===w.length)m.set(w[0].pageX,w[0].pageY);else{const t=.5*(w[0].pageX+w[1].pageX),e=.5*(w[0].pageY+w[1].pageY);m.set(t,e)}}function D(){if(1===w.length)v.set(w[0].pageX,w[0].pageY);else{const t=.5*(w[0].pageX+w[1].pageX),e=.5*(w[0].pageY+w[1].pageY);v.set(t,e)}}function F(){const t=w[0].pageX-w[1].pageX,e=w[0].pageY-w[1].pageY,i=Math.sqrt(t*t+e*e);C.set(0,i)}function U(t){if(1==w.length)y.set(t.pageX,t.pageY);else{const e=Q(t),i=.5*(t.pageX+e.x),o=.5*(t.pageY+e.y);y.set(i,o)}g.subVectors(y,m).multiplyScalar(i.rotateSpeed);const e=i.domElement;T(2*Math.PI*g.x/e.clientHeight),A(2*Math.PI*g.y/e.clientHeight),m.copy(y)}function V(t){if(1===w.length)b.set(t.pageX,t.pageY);else{const e=Q(t),i=.5*(t.pageX+e.x),o=.5*(t.pageY+e.y);b.set(i,o)}P.subVectors(b,v).multiplyScalar(i.panSpeed),O(P.x,P.y),v.copy(b)}function B(t){const e=Q(t),o=t.pageX-e.x,n=t.pageY-e.y,r=Math.sqrt(o*o+n*n);S.set(0,r),E.set(0,Math.pow(S.y/C.y,i.zoomSpeed)),k(E.y),C.copy(S)}function H(t){!1!==i.enabled&&(0===w.length&&(i.domElement.ownerDocument.addEventListener("pointermove",j),i.domElement.ownerDocument.addEventListener("pointerup",Y)),function(t){w.push(t)}(t),"touch"===t.pointerType?function(t){switch(K(t),w.length){case 1:switch(i.touches.ONE){case o.TOUCH.ROTATE:if(!1===i.enableRotate)return;I(),l=a.TOUCH_ROTATE;break;case o.TOUCH.PAN:if(!1===i.enablePan)return;D(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(i.touches.TWO){case o.TOUCH.DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;i.enableZoom&&F(),i.enablePan&&D(),l=a.TOUCH_DOLLY_PAN;break;case o.TOUCH.DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;i.enableZoom&&F(),i.enableRotate&&I(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(r)}(t):function(t){let e;switch(t.button){case 0:e=i.mouseButtons.LEFT;break;case 1:e=i.mouseButtons.MIDDLE;break;case 2:e=i.mouseButtons.RIGHT;break;default:e=-1}switch(e){case o.MOUSE.DOLLY:if(!1===i.enableZoom)return;!function(t){C.set(t.clientX,t.clientY)}(t),l=a.DOLLY;break;case o.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===i.enablePan)return;N(t),l=a.PAN}else{if(!1===i.enableRotate)return;R(t),l=a.ROTATE}break;case o.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===i.enableRotate)return;R(t),l=a.ROTATE}else{if(!1===i.enablePan)return;N(t),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(r)}(t))}function j(t){!1!==i.enabled&&("touch"===t.pointerType?function(t){switch(K(t),l){case a.TOUCH_ROTATE:if(!1===i.enableRotate)return;U(t),i.update();break;case a.TOUCH_PAN:if(!1===i.enablePan)return;V(t),i.update();break;case a.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;!function(t){i.enableZoom&&B(t),i.enablePan&&V(t)}(t),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;!function(t){i.enableZoom&&B(t),i.enableRotate&&U(t)}(t),i.update();break;default:l=a.NONE}}(t):function(t){if(!1===i.enabled)return;switch(l){case a.ROTATE:if(!1===i.enableRotate)return;!function(t){y.set(t.clientX,t.clientY),g.subVectors(y,m).multiplyScalar(i.rotateSpeed);const e=i.domElement;T(2*Math.PI*g.x/e.clientHeight),A(2*Math.PI*g.y/e.clientHeight),m.copy(y),i.update()}(t);break;case a.DOLLY:if(!1===i.enableZoom)return;!function(t){S.set(t.clientX,t.clientY),E.subVectors(S,C),E.y>0?k(x()):E.y<0&&z(x()),C.copy(S),i.update()}(t);break;case a.PAN:if(!1===i.enablePan)return;!function(t){b.set(t.clientX,t.clientY),P.subVectors(b,v).multiplyScalar(i.panSpeed),O(P.x,P.y),v.copy(b),i.update()}(t)}}(t))}function Y(t){!1!==i.enabled&&(t.pointerType,i.dispatchEvent(s),l=a.NONE,W(t),0===w.length&&(i.domElement.ownerDocument.removeEventListener("pointermove",j),i.domElement.ownerDocument.removeEventListener("pointerup",Y)))}function X(t){W(t)}function G(t){!1===i.enabled||!1===i.enableZoom||l!==a.NONE&&l!==a.ROTATE||(t.preventDefault(),i.dispatchEvent(r),function(t){t.deltaY<0?z(x()):t.deltaY>0&&k(x()),i.update()}(t),i.dispatchEvent(s))}function q(t){!1!==i.enabled&&!1!==i.enablePan&&function(t){let e=!1;switch(t.code){case i.keys.UP:O(0,i.keyPanSpeed),e=!0;break;case i.keys.BOTTOM:O(0,-i.keyPanSpeed),e=!0;break;case i.keys.LEFT:O(i.keyPanSpeed,0),e=!0;break;case i.keys.RIGHT:O(-i.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),i.update())}(t)}function Z(t){!1!==i.enabled&&t.preventDefault()}function W(t){delete M[t.pointerId];for(let e=0;e<w.length;e++)if(w[e].pointerId==t.pointerId)return void w.splice(e,1)}function K(t){let e=M[t.pointerId];void 0===e&&(e=new o.Vector2,M[t.pointerId]=e),e.set(t.pageX,t.pageY)}function Q(t){const e=t.pointerId===w[0].pointerId?w[1]:w[0];return M[e.pointerId]}i.domElement.addEventListener("contextmenu",Z),i.domElement.addEventListener("pointerdown",H),i.domElement.addEventListener("pointercancel",X),i.domElement.addEventListener("wheel",G,{passive:!1}),this.update()}}class l extends a{constructor(t,e){super(t,e),this.screenSpacePanning=!1,this.mouseButtons.LEFT=o.MOUSE.PAN,this.mouseButtons.RIGHT=o.MOUSE.ROTATE,this.touches.ONE=o.TOUCH.PAN,this.touches.TWO=o.TOUCH.DOLLY_ROTATE}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e,i){this.startCoordinates=[0,0],this.svgElement=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgElement.style.display="none",this.svgElement.style.height="100%",this.svgElement.style.width="100%",this.svgElement.style.position="absolute",t.insertAdjacentElement("afterbegin",this.svgElement),this.rectElement=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.rectElement.style.stroke=i.select.stroke,this.rectElement.style.strokeDasharray=i.select.strokeDashArray,this.rectElement.style.strokeWidth=""+i.select.strokeWidth,this.rectElement.style.fill=i.select.fill,this.rectElement.style.fillOpacity=""+i.select.fillOpacity,this.svgElement.appendChild(this.rectElement),this.selectionCallback=e,this.isMouseDown=!1}return t.prototype.onMouseDown=function(t,e){this.isMouseDown=!0,this.rectElement.style.display="block",this.svgElement.style.display="block",this.startCoordinates=[t,e],this.lastBoundingBox={x:this.startCoordinates[0],y:this.startCoordinates[1],width:1,height:1}},t.prototype.onMouseMove=function(t,e){this.isMouseDown&&(this.lastBoundingBox.x=Math.min(t,this.startCoordinates[0]),this.lastBoundingBox.y=Math.max(e,this.startCoordinates[1]),this.lastBoundingBox.width=Math.max(t,this.startCoordinates[0])-this.lastBoundingBox.x,this.lastBoundingBox.height=this.lastBoundingBox.y-Math.min(e,this.startCoordinates[1]),this.rectElement.setAttribute("x",""+this.lastBoundingBox.x),this.rectElement.setAttribute("y",""+(this.lastBoundingBox.y-this.lastBoundingBox.height)),this.rectElement.setAttribute("width",""+this.lastBoundingBox.width),this.rectElement.setAttribute("height",""+this.lastBoundingBox.height))},t.prototype.onMouseUp=function(){this.isMouseDown=!1,this.svgElement.style.display="none",this.rectElement.style.display="none",this.rectElement.setAttribute("width","0"),this.rectElement.setAttribute("height","0"),this.selectionCallback(this.lastBoundingBox)},t}();e.ScatterPlotRectangleSelector=o},function(t,e,i){"use strict";var o=this&&this.__read||function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,n,r=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=new Map,s=/^(rgba|hsla)\((\d+),\s*(\d+%?),\s*(\d+%?)(?:,\s*(\d+(?:\.\d+)?))?\)$/;e.parseColor=function(t){if(r.has(t))return r.get(t);var e=function(t){var e=s.exec(t);if(e){var i=o(e,6),n=(i[0],i[1]),r=i[2],a=i[3],l=i[4],c=i[5];return{colorString:n.replace("a","")+"("+r+","+a+","+l+")",opacity:parseFloat(c)}}return{colorString:t,opacity:1}}(t),i=e.colorString,a=e.opacity,l=new n.Color(i),c={r:l.r,g:l.g,b:l.b,opacity:a};return r.set(t,c),c}},function(t,e,i){"use strict";var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){var i,n;void 0===e&&(e=[]),this.points=t,this.metadata=e;var r=t[0].length;if(2!==r&&3!==r)throw new Error("Points must be an array of either 2 or 3 dimensional number arrays");try{for(var s=o(t),a=s.next();!a.done;a=s.next()){if(r!==a.value.length)throw new Error("Points must be an array of either 2 or 3 dimensional number arrays")}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}this.dimensions=r}return t.prototype.setSpriteMetadata=function(t){this.spriteMetadata=t},t}();e.Dataset=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.makeStyles=function(t){var e={backgroundColor:"#ffffff",axesVisible:!0,fog:{color:"#ffffff",enabled:!0,threshold:5e3},label:{fontSize:10,scaleDefault:1,scaleLarge:2,fillColorSelected:"#000000",fillColorHover:"#000000",strokeColorSelected:"#ffffff",strokeColorHover:"#ffffff",strokeWidth:3,fillWidth:6},label3D:{fontSize:80,scale:2.2,color:"black",backgroundColor:"#ffffff",colorUnselected:"#ffffff",colorNoSelection:"#ffffff"},point:{colorUnselected:"rgba(227, 227, 227, 0.7)",colorNoSelection:"rgba(117, 117, 217, 0.7)",colorSelected:"rgba(250, 102, 102, 0.7)",colorHover:"rgba(118, 11, 79, 0.7)",scaleDefault:1,scaleSelected:1.2,scaleHover:1.2},polyline:{startHue:60,endHue:360,saturation:1,lightness:.3,defaultOpacity:.2,defaultLineWidth:2,selectedOpacity:.9,selectedLineWidth:3,deselectedOpacity:.05},select:{fill:"#dddddd",fillOpacity:.2,stroke:"#aaaaaa",strokeWidth:2,strokeDashArray:"10 5"},sprites:{minPointSize:5,imageSize:30,colorUnselected:"#ffffff",colorNoSelection:"#ffffff"}};if(void 0===t)return e;for(var i in e){var o=i;"object"==typeof e[o]&&"object"==typeof t[o]?e[o]=Object.assign(e[o],t[o]):void 0!==t[o]&&(e[o]=t[o])}return e}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),n=i(1),r=i(3),s=function(t,e){return"\n      attribute vec2 posObj;\n      attribute vec4 color;\n      varying vec2 vUv;\n      varying vec4 vColor;\n\n      void main() {\n        vUv = uv;\n        vColor = color;\n\n        // Rotate label to face camera.\n\n        vec4 vRight = vec4(\n          modelViewMatrix[0][0], modelViewMatrix[1][0], modelViewMatrix[2][0], 0);\n\n        vec4 vUp = vec4(\n          modelViewMatrix[0][1], modelViewMatrix[1][1], modelViewMatrix[2][1], 0);\n\n        vec4 vAt = -vec4(\n          modelViewMatrix[0][2], modelViewMatrix[1][2], modelViewMatrix[2][2], 0);\n\n        mat4 pointToCamera = mat4(vRight, vUp, vAt, vec4(0, 0, 0, 1));\n\n        vec2 scaledPos = posObj * "+1/t+" * "+e+";\n\n        vec4 posRotated = pointToCamera * vec4(scaledPos, 0, 1);\n        vec4 mvPosition = modelViewMatrix * (vec4(position, 0) + posRotated);\n        gl_Position = projectionMatrix * mvPosition;\n      }"},a=function(){function t(t){this.styles=t,this.id="3D_LABELS",this.labelStrings=[],this.worldSpacePointPositions=new Float32Array(0),this.pickingColors=new Float32Array(0),this.renderColors=new Float32Array(0),this.uniforms={},this.totalVertexCount=0,this.labelVertexMap=[]}return t.prototype.createGlyphTexture=function(){var t=this.styles.label3D,e=t.fontSize,i=t.backgroundColor,o=t.color,r=document.createElement("canvas");r.width=8192,r.height=e;var s=r.getContext("2d");s.font="bold "+e+"px roboto",s.textBaseline="top",s.fillStyle=i,s.rect(0,0,r.width,r.height),s.fill(),s.fillStyle=o;for(var a=s.measureText(" ").width,l=new Float32Array(256),c=new Float32Array(256),h=0,u=0;u<256;u++){var p=" "+String.fromCharCode(u),d=s.measureText(p).width;l[u]=d-a,c[u]=h,s.fillText(p,h-a,0),h+=d}return{texture:n.createTextureFromCanvas(r),lengths:l,offsets:c}},t.prototype.processLabelVerts=function(t){var e=0;this.labelVertexMap=[];for(var i=0;i<t;i++){for(var o=this.labelStrings[i],n=[],r=0;r<o.length;r++){for(var s=0;s<6;s++)n.push(6*e+s);e++}this.labelVertexMap.push(n)}this.totalVertexCount=6*e},t.prototype.createColorBuffers=function(t){var e=this;this.pickingColors=new Float32Array(this.totalVertexCount*r.RGB_NUM_ELEMENTS),this.renderColors=new Float32Array(this.totalVertexCount*r.RGB_NUM_ELEMENTS);for(var i=function(t){var i=new o.Color(t);n.labelVertexMap[t].forEach((function(t){e.pickingColors[r.RGB_NUM_ELEMENTS*t]=i.r,e.pickingColors[r.RGB_NUM_ELEMENTS*t+1]=i.g,e.pickingColors[r.RGB_NUM_ELEMENTS*t+2]=i.b,e.renderColors[r.RGB_NUM_ELEMENTS*t]=1,e.renderColors[r.RGB_NUM_ELEMENTS*t+1]=1,e.renderColors[r.RGB_NUM_ELEMENTS*t+2]=1}))},n=this,s=0;s<t;s++)i(s)},t.prototype.createLabels=function(){var t=this,e=this.styles.label3D,i=e.fontSize,a=e.scale;if(null!=this.labelStrings&&null!=this.worldSpacePointPositions){var l=this.worldSpacePointPositions.length/r.XYZ_NUM_ELEMENTS;if(l===this.labelStrings.length){this.glyphTexture=this.createGlyphTexture(),this.uniforms={glyphTexture:{value:null},picking:{value:!1}},this.material=new o.ShaderMaterial({uniforms:this.uniforms,transparent:!0,vertexShader:s(i,a),fragmentShader:"\n      uniform sampler2D glyphTexture;\n      uniform bool picking;\n      varying vec2 vUv;\n      varying vec4 vColor;\n\n      void main() {\n        if (picking) {\n          gl_FragColor = vColor;\n        } else {\n          vec4 fromTexture = texture(glyphTexture, vUv);\n          gl_FragColor = vColor * fromTexture;\n        }\n      }"}),this.processLabelVerts(l),this.createColorBuffers(l);var c=new Float32Array(this.totalVertexCount*r.XYZ_NUM_ELEMENTS);this.positions=new o.BufferAttribute(c,r.XYZ_NUM_ELEMENTS);var h=new Float32Array(this.totalVertexCount*r.XYZ_NUM_ELEMENTS),u=new Float32Array(this.totalVertexCount*r.UV_NUM_ELEMENTS),p=new Float32Array(this.totalVertexCount*r.RGB_NUM_ELEMENTS),d=new o.BufferAttribute(h,2),f=new o.BufferAttribute(u,r.UV_NUM_ELEMENTS),m=new o.BufferAttribute(p,r.RGB_NUM_ELEMENTS);this.geometry=new o.BufferGeometry,this.geometry.setAttribute("posObj",d),this.geometry.setAttribute("position",this.positions),this.geometry.setAttribute("uv",f),this.geometry.setAttribute("color",m);for(var y=0,g=0;g<l;g++){for(var v=this.labelStrings[g],b=0,P=0;P<v.length;P++){var C=v.charCodeAt(P);b+=this.glyphTexture.lengths[C]}b/=-2;for(P=0;P<v.length;P++){C=v.charCodeAt(P);var S=this.glyphTexture.lengths[C],E=(b+S)/i,w=b/i,M=i/i;d.setXY(6*y+0,w,0),d.setXY(6*y+1,E,0),d.setXY(6*y+2,w,M),d.setXY(6*y+3,w,M),d.setXY(6*y+4,E,0),d.setXY(6*y+5,E,M);var x=this.glyphTexture.offsets[C],T=this.glyphTexture.offsets[C]+S;x/=8192,T/=8192;f.setXY(6*y+0,x,1),f.setXY(6*y+1,T,1),f.setXY(6*y+2,x,0),f.setXY(6*y+3,x,0),f.setXY(6*y+4,T,1),f.setXY(6*y+5,T,0),y++,b+=S}}var A=function(e){var i=n.vector3FromPackedArray(_.worldSpacePointPositions,e);_.labelVertexMap[e].forEach((function(e){t.positions.setXYZ(e,i.x,i.y,i.z)}))},_=this;for(g=0;g<l;g++)A(g);this.labelsMesh=new o.Mesh(this.geometry,this.material),this.labelsMesh.frustumCulled=!1,this.scene.add(this.labelsMesh)}}},t.prototype.colorLabels=function(t){if(null!=this.labelStrings&&null!=this.geometry&&null!=t){var e=this.geometry.getAttribute("color");e.array=this.renderColors;for(var i=t.length/r.RGBA_NUM_ELEMENTS,n=0,s=0;s<i;++s){for(var a=new o.Color(t[n],t[n+1],t[n+2]),l=this.labelVertexMap[s].length,c=0;c<l;++c)e.setXYZ(this.labelVertexMap[s][c],a.r,a.g,a.b);n+=r.RGBA_NUM_ELEMENTS}e.needsUpdate=!0}},t.prototype.setScene=function(t){this.scene=t},t.prototype.dispose=function(){this.labelsMesh&&(this.scene&&this.scene.remove(this.labelsMesh),this.labelsMesh=null),this.geometry&&(this.geometry.dispose(),this.geometry=null),null!=this.glyphTexture&&null!=this.glyphTexture.texture&&(this.glyphTexture.texture.dispose(),this.glyphTexture.texture=null)},t.prototype.onPickingRender=function(t){if(null!=this.geometry){this.material.uniforms.glyphTexture.value=this.glyphTexture.texture,this.material.uniforms.picking.value=!0;var e=this.geometry.getAttribute("color");e.array=this.pickingColors,e.needsUpdate=!0}else this.createLabels()},t.prototype.onRender=function(t){if(null!=this.geometry){this.colorLabels(t.pointColors),this.material.uniforms.glyphTexture.value=this.glyphTexture.texture,this.material.uniforms.picking.value=!1;var e=this.geometry.getAttribute("color");e.array=this.renderColors,e.needsUpdate=!0}else this.createLabels()},t.prototype.onPointPositionsChanged=function(t){this.worldSpacePointPositions=t,this.dispose()},t.prototype.setLabelStrings=function(t){this.labelStrings=t,this.dispose()},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizer3DLabels=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),n=i(2),r=i(1),s=i(3),a=function(t){return"\n    // Index of the specific vertex (passed in as bufferAttribute), and the\n    // variable that will be used to pass it to the fragment shader.\n    attribute float spriteIndex;\n    attribute vec4 color;\n    attribute float scaleFactor;\n\n    varying vec2 xyIndex;\n    varying vec4 vColor;\n\n    uniform bool sizeAttenuation;\n    uniform float pointSize;\n    uniform float spritesPerRow;\n    uniform float spritesPerColumn;\n\n    varying float fogDepth;\n\n    void main() {\n      // Pass index and color values to fragment shader.\n      vColor = color;\n      xyIndex = vec2(mod(spriteIndex, spritesPerRow),\n                floor(spriteIndex / spritesPerColumn));\n\n      // Transform current vertex by modelViewMatrix (model world position and\n      // camera world position matrix).\n      vec4 cameraSpacePos = modelViewMatrix * vec4(position, 1.0);\n\n      // Project vertex in camera-space to screen coordinates using the camera's\n      // projection matrix.\n      gl_Position = projectionMatrix * cameraSpacePos;\n\n      // Create size attenuation (if we're in 3D mode) by making the size of\n      // each point inversly proportional to its distance to the camera.\n      float outputPointSize = pointSize;\n      if (sizeAttenuation) {\n        outputPointSize = -pointSize / cameraSpacePos.z;\n        fogDepth = pointSize / outputPointSize * 1.2;\n      } else {  // Create size attenuation (if we're in 2D mode)\n        const float PI = 3.1415926535897932384626433832795;\n        const float minScale = 0.1;  // minimum scaling factor\n        const float outSpeed = 2.0;  // shrink speed when zooming out\n        const float outNorm = (1. - minScale) / atan(outSpeed);\n        const float maxScale = 15.0;  // maximum scaling factor\n        const float inSpeed = 0.02;  // enlarge speed when zooming in\n        const float zoomOffset = 0.3;  // offset zoom pivot\n        float zoom = projectionMatrix[0][0] + zoomOffset;  // zoom pivot\n        float scale = zoom < 1. ? 1. + outNorm * atan(outSpeed * (zoom - 1.)) :\n                      1. + 2. / PI * (maxScale - 1.) * atan(inSpeed * (zoom - 1.));\n        outputPointSize = pointSize * scale;\n      }\n\n      gl_PointSize =\n        max(outputPointSize * scaleFactor, "+t.toFixed(1)+");\n    }"},l="\n    bool point_in_unit_circle(vec2 spriteCoord) {\n      vec2 centerToP = spriteCoord - vec2(0.5, 0.5);\n      return dot(centerToP, centerToP) < (0.5 * 0.5);\n    }\n\n    bool point_in_unit_equilateral_triangle(vec2 spriteCoord) {\n      vec3 v0 = vec3(0, 1, 0);\n      vec3 v1 = vec3(0.5, 0, 0);\n      vec3 v2 = vec3(1, 1, 0);\n      vec3 p = vec3(spriteCoord, 0);\n      float p_in_v0_v1 = cross(v1 - v0, p - v0).z;\n      float p_in_v1_v2 = cross(v2 - v1, p - v1).z;\n      return (p_in_v0_v1 > 0.0) && (p_in_v1_v2 > 0.0);\n    }\n\n    bool point_in_unit_square(vec2 spriteCoord) {\n      return true;\n    }\n  ",c="\n    varying vec2 xyIndex;\n    varying vec4 vColor;\n\n    uniform sampler2D spriteTexture;\n    uniform float spritesPerRow;\n    uniform float spritesPerColumn;\n    uniform bool isImage;\n\n    "+o.ShaderChunk.common+"\n    "+l+"\n    uniform vec3 fogColor;\n    varying float fogDepth;\n\t\tuniform float fogNear;\n    uniform float fogFar;\n\n    void main() {\n      if (isImage) {\n        // Coordinates of the vertex within the entire sprite image.\n        vec2 coords =\n          (gl_PointCoord + xyIndex) / vec2(spritesPerRow, spritesPerColumn);\n        gl_FragColor = vColor * texture(spriteTexture, coords);\n      } else {\n        bool inside = point_in_unit_circle(gl_PointCoord);\n        if (!inside) {\n          discard;\n        }\n        gl_FragColor = vColor;\n      }\n      float fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n      gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n    }",h=function(){function t(t,e){this.styles=t,this.id="SPRITES",this.isSpriteSheetMode=!1,this.spritesPerRow=0,this.spritesPerColumn=0,this.spriteDimensions=[0,0],this.worldSpacePointPositions=new Float32Array(0),this.pickingColors=new Float32Array(0),this.renderColors=new Float32Array(0),this.standinTextureForPoints=r.createTextureFromCanvas(document.createElement("canvas")),e&&(this.spriteSheetParams=e,this.setSpriteSheet(e),this.isSpriteSheetMode=!0),this.renderMaterial=this.createRenderMaterial(),this.pickingMaterial=this.createPickingMaterial()}return t.prototype.createUniforms=function(){return{spriteTexture:{type:"t"},spritesPerRow:{type:"f"},spritesPerColumn:{type:"f"},fogColor:{type:"c"},fogNear:{type:"f"},fogFar:{type:"f"},isImage:{type:"bool"},sizeAttenuation:{type:"bool"},pointSize:{type:"f"}}},t.prototype.createRenderMaterial=function(){this.isSpriteSheetMode;var t=this.createUniforms();return new o.ShaderMaterial({uniforms:t,vertexShader:a(this.styles.sprites.minPointSize),fragmentShader:c,transparent:!0,depthFunc:o.LessDepth,fog:this.styles.fog.enabled,blending:o.NormalBlending})},t.prototype.createPickingMaterial=function(){var t=this.createUniforms();return new o.ShaderMaterial({uniforms:t,vertexShader:a(this.styles.sprites.minPointSize),fragmentShader:"\n    varying vec2 xyIndex;\n    varying vec4 vColor;\n    uniform bool isImage;\n\n    \n    bool point_in_unit_circle(vec2 spriteCoord) {\n      vec2 centerToP = spriteCoord - vec2(0.5, 0.5);\n      return dot(centerToP, centerToP) < (0.5 * 0.5);\n    }\n\n    bool point_in_unit_equilateral_triangle(vec2 spriteCoord) {\n      vec3 v0 = vec3(0, 1, 0);\n      vec3 v1 = vec3(0.5, 0, 0);\n      vec3 v2 = vec3(1, 1, 0);\n      vec3 p = vec3(spriteCoord, 0);\n      float p_in_v0_v1 = cross(v1 - v0, p - v0).z;\n      float p_in_v1_v2 = cross(v2 - v1, p - v1).z;\n      return (p_in_v0_v1 > 0.0) && (p_in_v1_v2 > 0.0);\n    }\n\n    bool point_in_unit_square(vec2 spriteCoord) {\n      return true;\n    }\n  \n\n    varying float fogDepth;\n\n    void main() {\n      xyIndex; // Silence 'unused variable' warning.\n      fogDepth; // Silence 'unused variable' warning.\n      if (isImage) {\n        gl_FragColor = vColor;\n      } else {\n        bool inside = point_in_unit_circle(gl_PointCoord);\n        if (!inside) {\n          discard;\n        }\n        gl_FragColor = vColor;\n      }\n    }",transparent:!0,depthTest:!0,depthWrite:!0,fog:!1,blending:o.NormalBlending})},t.prototype.createPointSprites=function(t,e){var i=null!=e?e.length/s.XYZ_NUM_ELEMENTS:0,n=this.createGeometry(i);this.fog=new o.Fog(16777215),this.points=new o.Points(n,this.renderMaterial),this.points.frustumCulled=!1,null!=this.spriteIndexBufferAttribute&&this.points.geometry.setAttribute("spriteIndex",this.spriteIndexBufferAttribute),t.add(this.points)},t.prototype.calculatePointSize=function(t){var e=this.styles.sprites.imageSize;if(this.texture)return t?e:this.spriteDimensions[0];var i=null!=this.worldSpacePointPositions?this.worldSpacePointPositions.length/s.XYZ_NUM_ELEMENTS:1,o=200/Math.log(i)/Math.log(8);return t?o:o/1.5},t.prototype.createGeometry=function(t){var e=t;this.pickingColors=new Float32Array(e*s.RGBA_NUM_ELEMENTS);for(var i=0,n=0;n<e;n++){var r=new o.Color(n);this.pickingColors[i++]=r.r,this.pickingColors[i++]=r.g,this.pickingColors[i++]=r.b,this.pickingColors[i++]=1}var a=new o.BufferGeometry;return a.setAttribute("position",new o.BufferAttribute(new Float32Array([]),s.XYZ_NUM_ELEMENTS)),a.setAttribute("color",new o.BufferAttribute(new Float32Array([]),s.RGBA_NUM_ELEMENTS)),a.setAttribute("scaleFactor",new o.BufferAttribute(new Float32Array([]),s.INDEX_NUM_ELEMENTS)),a.computeVertexNormals(),a},t.prototype.setFogDistances=function(t,e,i){var o=this.styles.fog,n=o.threshold,r=o.enabled;if(t&&r){var a=this.worldSpacePointPositions.length/s.XYZ_NUM_ELEMENTS;this.fog.near=e;var l=2-Math.min(a,n)/n;this.fog.far=i*l}else this.fog.near=1/0,this.fog.far=1/0},t.prototype.dispose=function(){this.disposeGeometry(),this.disposeSpriteSheet()},t.prototype.disposeGeometry=function(){null!=this.points&&(this.scene.remove(this.points),this.points.geometry.dispose(),this.points=null,this.worldSpacePointPositions=null)},t.prototype.disposeSpriteSheet=function(){this.texture&&this.texture.dispose(),this.texture=null,this.renderMaterial=null,this.pickingMaterial=null,this.spriteSheetImage=null},t.prototype.setScene=function(t){this.scene=t},t.prototype.setSpriteSheet=function(t){var e=this,i=t.spriteDimensions,n=t.spriteIndices,a=t.onImageLoad,l=t.spritesheetImage;if("string"==typeof l){var c=l;(l=new Image).src=c}this.spriteSheetImage=l,this.texture=r.createTextureFromImage(this.spriteSheetImage,(function(){e.spritesPerRow=e.spriteSheetImage.width/i[0],e.spritesPerColumn=e.spriteSheetImage.height/i[1],a()})),this.spriteDimensions=i,this.spriteIndexBufferAttribute=new o.BufferAttribute(n,s.INDEX_NUM_ELEMENTS),null!=this.points&&this.points.geometry.setAttribute("spriteIndex",this.spriteIndexBufferAttribute)},t.prototype.onPointPositionsChanged=function(t){null!=this.points&&this.worldSpacePointPositions.length!==t.length&&this.disposeGeometry(),this.worldSpacePointPositions=t,null==this.points&&this.createPointSprites(this.scene,t),this.spriteSheetParams&&this.setSpriteSheet(this.spriteSheetParams),this.renderMaterial=this.createRenderMaterial(),this.pickingMaterial=this.createPickingMaterial();var e=this.points.geometry.getAttribute("position");e.array=t,e.count=t.length/s.XYZ_NUM_ELEMENTS,e.needsUpdate=!0},t.prototype.onPickingRender=function(t){var e=t.cameraType===n.CameraType.Perspective;this.pickingMaterial.uniforms.spritesPerRow.value=this.spritesPerRow,this.pickingMaterial.uniforms.spritesPerRow.value=this.spritesPerColumn,this.pickingMaterial.uniforms.sizeAttenuation.value=e,this.pickingMaterial.uniforms.pointSize.value=this.calculatePointSize(e),this.points.material=this.pickingMaterial;var i=this.points.geometry.getAttribute("color");i.array=this.pickingColors,i.count=this.pickingColors.length/s.RGBA_NUM_ELEMENTS,i.needsUpdate=!0;var o=this.points.geometry.getAttribute("scaleFactor");o.array=t.pointScaleFactors,o.count=t.pointScaleFactors.length,o.count=t.pointScaleFactors.length/s.INDEX_NUM_ELEMENTS,o.needsUpdate=!0},t.prototype.onRender=function(t){var e=t.camera instanceof o.PerspectiveCamera;this.setFogDistances(e,t.nearestCameraSpacePointZ,t.farthestCameraSpacePointZ),this.scene.fog=this.fog,this.scene.fog.color=new o.Color(t.backgroundColor),this.renderMaterial.uniforms.fogColor.value=this.scene.fog.color,this.renderMaterial.uniforms.fogNear.value=this.fog.near,this.renderMaterial.uniforms.fogFar.value=this.fog.far,this.renderMaterial.uniforms.spritesPerRow.value=this.spritesPerRow,this.renderMaterial.uniforms.spritesPerColumn.value=this.spritesPerColumn,this.renderMaterial.uniforms.isImage.value=null!=this.texture,this.renderMaterial.uniforms.spriteTexture.value=null!=this.texture?this.texture:this.standinTextureForPoints,this.renderMaterial.uniforms.sizeAttenuation.value=e,this.renderMaterial.uniforms.pointSize.value=this.calculatePointSize(e),this.points.material=this.renderMaterial;var i=this.points.geometry.getAttribute("color");this.renderColors=t.pointColors,i.array=this.renderColors,i.count=this.renderColors.length/s.RGBA_NUM_ELEMENTS,i.needsUpdate=!0;var n=this.points.geometry.getAttribute("scaleFactor");n.array=t.pointScaleFactors,n.count=t.pointScaleFactors.length/s.INDEX_NUM_ELEMENTS,n.needsUpdate=!0},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizerSprites=h},function(t,e,i){"use strict";var o=this&&this.__read||function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,n,r=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i(2),s=i(15),a=i(1),l=function(){function t(t,e){this.styles=e,this.id="CANVAS_LABELS",this.worldSpacePointPositions=new Float32Array(0),this.labelsActive=!0,this.canvas=document.createElement("canvas"),t.appendChild(this.canvas),this.gc=this.canvas.getContext("2d"),this.canvas.style.position="absolute",this.canvas.style.left="0",this.canvas.style.top="0",this.canvas.style.pointerEvents="none"}return t.prototype.removeAllLabels=function(){var t=this.canvas.width*window.devicePixelRatio,e=this.canvas.height*window.devicePixelRatio;this.gc.clearRect(0,0,t,e)},t.prototype.makeLabels=function(t){if(null!=t.labels&&0!==t.labels.pointIndices.length&&null!=this.worldSpacePointPositions){var e,i=t.labels,l=t.cameraType===r.CameraType.Perspective,c=parseInt(this.gc.font,10),h=window.devicePixelRatio,u=this.canvas.width*h,p=this.canvas.height*h,d={loX:0,hiX:u,loY:0,hiY:p};e=new s.CollisionGrid(d,u/25,p/50);var f=[t.farthestCameraSpacePointZ,t.nearestCameraSpacePointZ],m=function(t){return a.scaleExponential(t,f,[.1,1])},y=t.camera.position,g=y.clone().sub(t.cameraTarget),v=new n.Vector3;this.gc.textBaseline="middle",this.gc.miterLimit=2;for(var b=Math.min(1e4,i.pointIndices.length),P=0;P<b;++P){var C,S=i.pointIndices[P];if(C=a.vector3FromPackedArray(this.worldSpacePointPositions,S),v.copy(y).sub(C),!(g.dot(v)<0)){var E=o(a.vector3DToScreenCoords(t.camera,t.screenWidth,t.screenHeight,C),2),w=E[0],M=E[1],x={loX:(w+=4)-2,hiX:w+1+2,loY:M-c/2-2,hiY:M+c/2+2};if(e.insert(x,!0)){var T=i.labelStrings[P],A=i.defaultFontSize*i.scaleFactors[P]*h;if(this.gc.font=A+"px roboto",x.hiX+=this.gc.measureText(T).width-1,e.insert(x)){var _=1;l&&1===i.useSceneOpacityFlags[P]&&(_=m(v.length())),this.gc.fillStyle=this.styleStringFromPackedRgba(i.fillColors,P,_),this.gc.strokeStyle=this.styleStringFromPackedRgba(i.strokeColors,P,_),this.gc.lineWidth=this.styles.label.strokeWidth,this.gc.strokeText(T,w,M),this.gc.lineWidth=this.styles.label.fillWidth,this.gc.fillText(T,w,M)}}}}}},t.prototype.styleStringFromPackedRgba=function(t,e,i){var o=3*e;return"rgba("+t[o]+","+t[o+1]+","+t[o+2]+","+i+")"},t.prototype.onResize=function(t,e){var i=window.devicePixelRatio;this.canvas.width=t*i,this.canvas.height=e*i,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"},t.prototype.dispose=function(){this.removeAllLabels()},t.prototype.onPointPositionsChanged=function(t){this.worldSpacePointPositions=t,this.removeAllLabels()},t.prototype.onRender=function(t){this.labelsActive&&(this.removeAllLabels(),this.makeLabels(t))},t.prototype.setScene=function(t){},t.prototype.onPickingRender=function(t){},t}();e.ScatterPlotVisualizerCanvasLabels=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e,i){this.bound=t,this.cellWidth=e,this.cellHeight=i,this.numHorizCells=Math.ceil(this.boundWidth(t)/e),this.numVertCells=Math.ceil(this.boundHeight(t)/i),this.grid=new Array(this.numHorizCells*this.numVertCells)}return t.prototype.boundWidth=function(t){return t.hiX-t.loX},t.prototype.boundHeight=function(t){return t.hiY-t.loY},t.prototype.boundsIntersect=function(t,e){return!(t.loX>e.hiX||t.loY>e.hiY||t.hiX<e.loX||t.hiY<e.loY)},t.prototype.insert=function(t,e){if(void 0===e&&(e=!1),t.hiX<this.bound.loX||t.loX>this.bound.hiX||t.hiY<this.bound.loY||t.loY>this.bound.hiY)return!1;for(var i=this.getCellX(t.loX),o=this.getCellX(t.hiX),n=this.getCellY(t.loY),r=this.getCellY(t.hiY),s=n*this.numHorizCells+i,a=s,l=n;l<=r;l++){for(var c=i;c<=o;c++){var h=this.grid[a++];if(h)for(var u=0;u<h.length;u++)if(this.boundsIntersect(t,h[u]))return!1}a+=this.numHorizCells-(o-i+1)}if(e)return!0;a=s;for(l=n;l<=r;l++){for(c=i;c<=o;c++)this.grid[a]?this.grid[a].push(t):this.grid[a]=[t],a++;a+=this.numHorizCells-(o-i+1)}return!0},t.prototype.getCellX=function(t){return Math.floor((t-this.bound.loX)/this.cellWidth)},t.prototype.getCellY=function(t){return Math.floor((t-this.bound.loY)/this.cellHeight)},t}();e.CollisionGrid=o},function(t,e,i){"use strict";var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i(1),s=i(3),a=function(){function t(){this.id="POLYLINES",this.sequences=[],this.polylines=[],this.polylinePositionBuffer={},this.polylineColorBuffer={},this.pointSequenceIndices=new Map}return t.prototype.getPointSequenceIndex=function(t){return this.pointSequenceIndices.get(t)},t.prototype.updateSequenceIndices=function(){for(var t=0;t<this.sequences.length;t++)for(var e=this.sequences[t],i=0;i<e.indices.length-1;i++){var o=e.indices[i];this.pointSequenceIndices.set(o,t),this.pointSequenceIndices.set(o+1,t)}},t.prototype.createPolylines=function(){var t,e;this.updateSequenceIndices();try{for(var i=o(this.polylines),r=i.next();!r.done;r=i.next()){var s=r.value;this.scene.remove(s),s.geometry.dispose()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.polylines=[];for(var a=0;a<this.sequences.length;a++){var l=new n.BufferGeometry;l.addAttribute("position",this.polylinePositionBuffer[a]),l.addAttribute("color",this.polylineColorBuffer[a]);var c=new n.LineBasicMaterial({linewidth:1,opacity:1,transparent:!0,vertexColors:!0});(s=new n.LineSegments(l,c)).frustumCulled=!1,this.polylines.push(s),this.scene.add(s)}},t.prototype.dispose=function(){var t,e;try{for(var i=o(this.polylines),n=i.next();!n.done;n=i.next()){var r=n.value;this.scene.remove(r),r.geometry.dispose()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.polylines=[],this.polylinePositionBuffer={},this.polylineColorBuffer={}},t.prototype.setScene=function(t){this.scene=t},t.prototype.setSequences=function(t){this.sequences=t},t.prototype.onPointPositionsChanged=function(t){if(null==t&&this.dispose(),null!=t&&0!==this.sequences.length){for(var e=0;e<this.sequences.length;e++){var i=2*((l=this.sequences[e]).indices.length-1),o=new Float32Array(i*s.XYZ_NUM_ELEMENTS);this.polylinePositionBuffer[e]=new n.BufferAttribute(o,s.XYZ_NUM_ELEMENTS);var a=new Float32Array(i*s.RGBA_NUM_ELEMENTS);this.polylineColorBuffer[e]=new n.BufferAttribute(a,s.RGBA_NUM_ELEMENTS)}for(e=0;e<this.sequences.length;e++){for(var l=this.sequences[e],c=0,h=0;h<l.indices.length-1;h++){var u=l.indices[h],p=l.indices[h+1],d=r.vector3FromPackedArray(t,u),f=r.vector3FromPackedArray(t,p);this.polylinePositionBuffer[e].setXYZ(c,d.x,d.y,d.z),this.polylinePositionBuffer[e].setXYZ(c+1,f.x,f.y,f.z),c+=2}this.polylinePositionBuffer[e].needsUpdate=!0}this.createPolylines()}},t.prototype.onRender=function(t){for(var e=0;e<this.polylines.length;e++){var i=this.polylines[e].material;i.opacity=t.polylineOpacities[e],i.linewidth=t.polylineWidths[e],this.polylineColorBuffer[e].array=t.polylineColors[e],this.polylineColorBuffer[e].needsUpdate=!0}},t.prototype.onPickingRender=function(t){},t.prototype.onResize=function(t,e){},t}();e.ScatterPlotVisualizerPolylines=a}])}));